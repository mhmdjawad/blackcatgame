(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const n of s.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&a(n)}).observe(document,{childList:!0,subtree:!0});function e(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(i){if(i.ep)return;i.ep=!0;const s=e(i);fetch(i.href,s)}})();let m=32,B=10;const Q=["üî•","üíß","üå±","üå™Ô∏è","‚ö°","‚òÄÔ∏è","üåë"];var Z={songData:[{i:[0,0,140,0,0,0,140,0,0,255,158,158,158,0,0,0,0,51,2,1,2,58,239,0,32,88,1,157,2],p:[1,1,1,1],c:[{n:[161,,,,,,,,,,,,,,,,163,,,,,,,,159],f:[]}]},{i:[0,91,128,0,0,95,128,12,0,0,12,0,72,0,0,0,0,0,0,0,2,255,0,0,32,83,3,130,4],p:[1,1,2,1],c:[{n:[144,,151,,149,,147,,146,,147,,146,,144,,144,,151,,149,,147,,146,,147,,146,,144],f:[]},{n:[156,,163,,161,,159,,158,,159,,158,,156,,156,,163,,161,,159,,158,,159,,158,,168],f:[]}]},{i:[0,16,133,0,0,28,126,12,0,0,2,0,60,0,0,0,0,0,0,0,2,91,0,0,32,47,3,157,2],p:[1,2,1,2],c:[{n:[144,,151,,149,,147,,146,,147,,146,,144,,144,,151,,149,,147,,146,,147,,146,,144],f:[]},{n:[168,,175,,173,,171,,170,,171,,170,,168,,168,,175,,173,,171,,170,,171,,170,,168],f:[]}]},{i:[0,255,116,79,0,255,116,0,83,0,4,6,69,52,0,0,0,0,0,0,2,14,0,0,32,0,0,0,0],p:[1,1,1,1],c:[{n:[144,,151,,149,,147,,146,,147,,146,,144,,144,,151,,149,,147,,146,,147,,146,,144,,,159,,,,159,,,,159,,,,,,,,,,,,159,,159],f:[]}]}],rowLen:8269,patternLen:32,endPattern:3,numChannels:4},_=[{v:"m",e:"üîÆ",c:"#f00"},{v:"f",e:"üî•",c:"#f00"},{v:"w",e:"üíß",c:"#00f"},{v:"e",e:"üå±",c:"#0a0"},{v:"i",e:"üå™Ô∏è",c:"#aaa"},{v:"z",e:"‚ö°",c:"#ff0"},{v:"l",e:"‚òÄÔ∏è",c:"#ffb"},{v:"d",e:"üåë",c:"#555"}];console.log(Q);console.log(_);var z=[{i:"mmmmmm",r:"m",isattack:!0,dmg:100,spd:0},{i:"mmmmm",r:"m",isattack:!0,dmg:40,spd:0},{i:"mmmm",r:"m",isattack:!0,dmg:15,spd:0},{i:"mmm",r:"m",isattack:!0,dmg:5,spd:0},{i:"mm",r:"m",isattack:!0,dmg:3,spd:0},{i:"ff",r:"m",isattack:!1,dmg:0,spd:0},{i:"ww",r:"m",isattack:!1,dmg:0,spd:0},{i:"ee",r:"m",isattack:!1,dmg:0,spd:0},{i:"ii",r:"m",isattack:!1,dmg:0,spd:0},{i:"zz",r:"m",isattack:!1,dmg:0,spd:0},{i:"ll",r:"m",isattack:!1,dmg:0,spd:0},{i:"dd",r:"m",isattack:!1,dmg:0,spd:0},{i:"mf",r:"f",isattack:!0,dmg:3,spd:0},{i:"mw",r:"w",isattack:!0,dmg:3,spd:0},{i:"me",r:"e",isattack:!0,dmg:3,spd:0},{i:"mi",r:"i",isattack:!0,dmg:3,spd:0},{i:"mz",r:"z",isattack:!0,dmg:3,spd:0},{i:"ml",r:"l",isattack:!0,dmg:3,spd:0},{i:"md",r:"d",isattack:!0,dmg:3,spd:0},{i:"mff",r:"f",isattack:!0,dmg:7,spd:0},{i:"mww",r:"w",isattack:!0,dmg:7,spd:0},{i:"mee",r:"e",isattack:!0,dmg:7,spd:0},{i:"mii",r:"i",isattack:!0,dmg:7,spd:0},{i:"mzz",r:"z",isattack:!0,dmg:7,spd:0},{i:"mll",r:"l",isattack:!0,dmg:7,spd:0},{i:"mdd",r:"ld",isattack:!0,dmg:7,spd:0},{i:"mfff",r:"f",isattack:!0,dmg:15,spd:0},{i:"mwww",r:"w",isattack:!0,dmg:15,spd:0},{i:"meee",r:"e",isattack:!0,dmg:15,spd:0},{i:"miii",r:"i",isattack:!0,dmg:15,spd:0},{i:"mzzz",r:"z",isattack:!0,dmg:15,spd:0},{i:"mlll",r:"l",isattack:!0,dmg:15,spd:0},{i:"mddd",r:"d",isattack:!0,dmg:15,spd:0},{i:"mfi",r:"f",isattack:!0,dmg:8,spd:0},{i:"mfe",r:"f",isattack:!0,dmg:8,spd:0},{i:"mwi",r:"w",isattack:!0,dmg:8,spd:0},{i:"mwe",r:"w",isattack:!0,dmg:8,spd:0}];function tt(g,t,e,a,i,s,n,o){g.save(),g.fillStyle=t,g.beginPath(),g.ellipse(e,a,i,s,n,o,Math.PI*2),g.fill(),g.restore()}function et(g,t,e,a){const i=[];for(let s=0;s<a;s++){const n=2*Math.PI*s/a,o=g+e*Math.cos(n),l=t+e*Math.sin(n);i.push({x:o,y:l})}return i}class F{x;y;w;h;sprite;onclick;constructor(t,e,a,i,s,n){this.x=t,this.y=e,this.w=a,this.h=i,this.sprite=s,this.onclick=n}handleTouchPos(t){return this.isInside(t.x,t.y)?(this.onclick&&this.onclick(this),!0):!1}isInside(t,e){return t>=this.x&&t<=this.x+this.w&&e>=this.y&&e<=this.y+this.h}draw(t){t.drawImage(this.sprite,this.x,this.y,this.w,this.h)}update(){}}class G{rows;cols;maze;constructor(t){this.maze=t,this.rows=t.length,this.cols=t[0]?.length??0}findPath(t,e,a,i){t=Math.floor(t),e=Math.floor(e),a=Math.floor(a),i=Math.floor(i);const s=[],n=new Set,o={},l=new Array(this.rows).fill(null).map(()=>new Array(this.cols).fill(1/0));l[t][e]=0;const h=new Array(this.rows).fill(null).map(()=>new Array(this.cols).fill(1/0));for(h[t][e]=this.heuristic(t,e,a,i),s.push([t,e]);s.length>0;){const c=this.findLowestFScore(s,h),[d,p]=c;if(d===a&&p===i)return this.reconstructPath(o,c);s.splice(s.indexOf(c),1),n.add(`${d}-${p}`);const f=this.getNeighbors(d,p);for(const u of f){const[w,v]=u;if(n.has(`${w}-${v}`)||this.maze[w][v])continue;const x=l[d][p]+1;x<l[w][v]&&(o[`${w}-${v}`]=c,l[w][v]=x,h[w][v]=x+this.heuristic(w,v,a,i),s.includes(u)||s.push(u))}}return null}heuristic(t,e,a,i){return Math.abs(t-a)+Math.abs(e-i)}findLowestFScore(t,e){let a=t[0],i=e[a[0]][a[1]];for(const s of t){const[n,o]=s;e[n][o]<i&&(a=s,i=e[n][o])}return a}getNeighbors(t,e){const a=[];return t>0&&a.push([t-1,e]),t<this.rows-1&&a.push([t+1,e]),e>0&&a.push([t,e-1]),e<this.cols-1&&a.push([t,e+1]),a}reconstructPath(t,e){const a=[e];for(;t.hasOwnProperty(`${e[0]}-${e[1]}`);)e=t[`${e[0]}-${e[1]}`],a.unshift(e);return a}}class it{game;blueprintasmatrix;colordict;map=r.EmptyCanv();pathfindermatrix;pathFinder=new G([]);collisionMat=[];constructor(t,e){this.game=t,this.blueprintasmatrix=e?r.getColorMatrix(e,a=>a==""?null:a):[],this.colordict=[{c:"#847e87",o:0,l:"",s:void 0}]}getMap(){return r.imgToCanvas(this.map)}getPathfindMatrix(t,e){var a={};for(let c in e)a[e[c].c]=e[c].o;for(var i=[],s=0;s<t.length;s++){i[s]=[];for(var n=0;n<t[s].length;n++){var o=t[n][s],l=a[o],h=l!=null&&l==0;i[s][n]=h?0:1}}return i}isObstacle(t={i:0,j:0}){try{var e=this.pathfindermatrix[t.i][t.j]==1;return e}catch{return!0}}findPathNormPt(t={i:0,j:0},e={i:0,j:0}){var a=this.pathFinder.findPath(t.i,t.j,e.i,e.j),i=[];if(a&&a.length>1)for(let o=1;o<a.length;o++){var s=a[o],n=r.Point({x:s[0]*m+m/2,y:s[1]*m+m/2});i.push(n)}return i}}class at{game;animations;animate;level;sprite;center;constructor(t,e){this.game=t,this.animations=[r.getEmojiSprite("üåÄ",m*2,1.3),r.getEmojiSprite("üåÄ",m*2,1),r.getEmojiSprite("üåÄ",m*2,1.1),r.getEmojiSprite("üåÄ",m*2,1.2)],this.animate={framerate:10,frame:0,index:0},this.level=this.evalDifficulity(e),this.sprite=this.animations[0],this.center=r.Point({x:e.x*m+this.sprite.w/2,y:e.y*m+this.sprite.h/2})}evalDifficulity(t){var e=t.x,a=t.y;const i=(e+a)/2;return i<8?1:i<16?2:i<24?3:i<32?4:i<40?5:i<48?6:i<56?7:i<64?8:9+Math.round(Math.random())}update(){this.animate.frame++,this.animate.frame>this.animate.framerate&&(this.sprite=this.animations[this.animate.index],this.animate.frame=0,this.animate.index=this.animate.index>=this.animations.length-1?0:this.animate.index+1)}draw(t){t.drawImage(this.sprite,this.center.x-this.sprite.w/2,this.center.y-this.sprite.h/2),t.fillStyle="blue",t.fillRect(this.center.x,this.center.y,2,2)}handleTouchPos(t){this.center.distance(t)<m*2&&(console.log("click near me",this),this.game.openPortalMenu(this))}}class st extends it{cw;ch;locations_portal;constructor(t){super(t,t.spriteEngine?.mapBlueprint),this.cw=this.game.canvasDim.w,this.ch=this.game.canvasDim.h;var e=I.GenDirtTile(m,m),a=I.GenWalkwayTile(m,m),i=I.GenWaterTile(m,m),s=r.getEmojiSprite("üå≥",m,1.3),n=r.getEmojiSprite("üè°",m*2,1.3),o=r.getEmojiSprite("üè†",m*2,1.3),l=r.getEmojiSprite("‚õ™",m*3,1.3),h=r.getEmojiSprite("üè´",m*3,1.3),c=r.getEmojiSprite("‚õ∫",m*3,1.3),d=I.GenCozyWallTile(m);this.locations_portal=[],this.colordict=[{c:"#99e550",o:0,l:"",s:void 0},{c:"#639bff",o:1,l:"",s:i},{c:"#6abe30",o:1,l:"",s},{c:"#76428a",o:1,l:"house1",s:n},{c:"#d77bba",o:1,l:"house2",s:o},{c:"#d9a066",o:0,l:"",s:e},{c:"#767676",o:1,l:"",s:d},{c:"#8f974a",o:1,l:"church",s:l},{c:"#fbf236",o:1,l:"townhall",s:h},{c:"#663931",o:0,l:"",s:a},{c:"#524b24",o:1,l:"tent",s:c},{c:"#222034",o:1,l:"portal",s:void 0}];for(let f=0;f<64;f++)for(let u=0;u<64;u++){var p=this.blueprintasmatrix[u][f];p=="#222034"&&this.locations_portal.push({i:f,j:u})}this.map=this.RenderMap(t.spriteEngine.mapBlueprint),this.pathfindermatrix=this.getPathfindMatrix(this.blueprintasmatrix,this.colordict),this.pathFinder=new G(this.pathfindermatrix)}RenderMap(t){const e={w:64,h:64};this.collisionMat=[];var a=I.GenFlowerGarden(e.w*m,e.h*m,m*m),i={};this.colordict.map(c=>i[c.c]=c.s);var s=r.getColorMatrix(t,(c="")=>c==""?null:c),n=r.makeCanvas(e.w*m,e.h*m),o=n.ctx;o.drawImage(a,0,0);for(let c=0;c<64;c++)for(let d=0;d<64;d++){var l=s[d][c],h=i[l];h!=null&&o.drawImage(h,c*m,d*m)}return n}}class ${animations;constructor(t){this.animations=t.spriteEngine?.AnimateCat()??[]}Idle(){return this.animations[0]}IdleAnimation(){return[this.animations[0],this.animations[1]]}WalkingAnimation(){var t=[];for(let e=2;e<=5;e++)t.push(this.animations[e]);return t}}class rt{mOscillators;mSong;mLastRow;mCurrentCol;mNumWords;mMixBuf;constructor(){this.mOscillators=[this.osc_sin,this.osc_square,this.osc_saw,this.osc_tri],this.mSong=null,this.mLastRow=0,this.mCurrentCol=0,this.mNumWords=0,this.mMixBuf=null}osc_sin(t){return Math.sin(t*6.283184)}osc_saw(t){return 2*(t%1)-1}osc_square(t){return t%1<.5?1:-1}osc_tri(t){const e=t%1*4;return e<2?e-1:3-e}getnotefreq(t){return .003959503758*2**((t-128)/12)}createNote(t,e,a){const i=this.mOscillators[t.i[0]],s=t.i[1],n=t.i[3]/32,o=this.mOscillators[t.i[4]],l=t.i[5],h=t.i[8]/32,c=t.i[9],d=t.i[10]*t.i[10]*4,p=t.i[11]*t.i[11]*4,f=t.i[12]*t.i[12]*4,u=1/f,w=-t.i[13]/16;let v=t.i[14];const x=a*2**(2-t.i[15]),y=new Int32Array(d+p+f);let M=0,S=0,A=0,b=0;for(let k=0,L=0;k<d+p+f;k++,L++){L>=0&&(v=v>>8|(v&255)<<4,L-=x,A=this.getnotefreq(e+(v&15)+t.i[2]-128),b=this.getnotefreq(e+(v&15)+t.i[6]-128)*(1+8e-4*t.i[7]));let C=1;k<d?C=k/d:k>=d+p&&(C=(k-d-p)*u,C=(1-C)*3**(w*C)),M+=A*C**n;let P=i(M)*s;S+=b*C**h,P+=o(S)*l,c&&(P+=(2*Math.random()-1)*c),y[k]=80*P*C|0}return y}initGenBuffer(t,e,a){this.init(t);var i=()=>{var s=this.generate();if(s==1){var n=this.createAudioBuffer(e);return a(n)}else requestAnimationFrame(i)};requestAnimationFrame(i)}init(t){this.mSong=t,this.mLastRow=t.endPattern,this.mCurrentCol=0,this.mNumWords=t.rowLen*t.patternLen*(this.mLastRow+1)*2,this.mMixBuf=new Int32Array(this.mNumWords)}generate(){let t,e,a,i,s,n,o,l,h,c,d,p;const f=new Int32Array(this.mNumWords),u=this.mSong.songData[this.mCurrentCol],w=this.mSong.rowLen,v=this.mSong.patternLen;let x=0,y=0,M,S,A=!1;const b=[];for(a=0;a<=this.mLastRow;++a)for(o=u.p[a],i=0;i<v;++i){const k=o?u.c[o-1].f[i]:0;k&&(u.i[k-1]=u.c[o-1].f[i+v]||0,k<17&&(b.length=0));const L=this.mOscillators[u.i[16]],C=u.i[17]/512,P=2**(u.i[18]-9)/w,Y=u.i[19],W=u.i[20],X=u.i[21]*43.23529*3.141592/44100,J=1-u.i[22]/255,j=u.i[23]*1e-5,K=u.i[24]/32,U=u.i[25]/512,V=6.283184*2**(u.i[26]-9)/w,O=u.i[27]/255,R=u.i[28]*w&-2;for(d=(a*v+i)*w,s=0;s<4;++s)if(n=o?u.c[o-1].n[i+s*v]:0,n){b[n]||(b[n]=this.createNote(u,n,w));const N=b[n];for(e=0,t=d*2;e<N.length;e++,t+=2)f[t]+=N[e]}for(e=0;e<w;e++)l=(d+e)*2,c=f[l],c||A?(p=X,Y&&(p*=L(P*l)*C+.5),p=1.5*Math.sin(p),x+=p*y,M=J*(c-y)-x,y+=p*M,c=W==3?y:W==1?M:x,j&&(c*=j,c=c<1?c>-1?this.osc_sin(c*.25):-1:1,c/=j),c*=K,A=c*c>1e-5,h=Math.sin(V*l)*U+.5,S=c*(1-h),c*=h):S=0,l>=R&&(S+=f[l-R+1]*O,c+=f[l-R]*O),f[l]=S|0,f[l+1]=c|0,this.mMixBuf[l]+=S|0,this.mMixBuf[l+1]+=c|0}return this.mCurrentCol++,this.mCurrentCol/this.mSong.numChannels}createAudioBuffer(t){const e=t.createBuffer(2,this.mNumWords/2,44100);for(let a=0;a<2;a++){const i=e.getChannelData(a);for(let s=a;s<this.mNumWords;s+=2)i[s>>1]=this.mMixBuf[s]/65536}return e}createWave(){const e=44+this.mNumWords*2-8,a=e-36,i=new Uint8Array(44+this.mNumWords*2);i.set([82,73,70,70,e&255,e>>8&255,e>>16&255,e>>24&255,87,65,86,69,102,109,116,32,16,0,0,0,1,0,2,0,68,172,0,0,16,177,2,0,4,0,16,0,100,97,116,97,a&255,a>>8&255,a>>16&255,a>>24&255]);for(let s=0,n=44;s<this.mNumWords;++s){let o=this.mMixBuf[s];o=o<-32767?-32767:o>32767?32767:o,i[n++]=o&255,i[n++]=o>>8&255}return i}getData(t,e){const a=2*Math.floor(t*44100),i=new Array(e);for(let s=0;s<2*e;s+=1){const n=a+s;i[s]=t>0&&n<this.mMixBuf.length?this.mMixBuf[n]/32768:0}return i}}class nt{audioContext;audioContextSingleFire;buffer1;buffer2;bgmTime;pausedTime;startTime;bgmsource;bgmBuffer;constructor(t=!0){this.audioContext=new window.AudioContext,this.audioContextSingleFire=new window.AudioContext,this.buffer1=this.generateShootingSound(),this.buffer2=this.generateExplosion();var e=new rt;this.bgmTime=0,this.pausedTime=0,this.startTime=0,e.initGenBuffer(Z,this.audioContext,a=>{this.bgmBuffer=a,t&&this.startBgm()})}generateShootingSound(){const t=this.audioContext.sampleRate,e=.3,a=this.audioContext.createBuffer(1,t*e,t),i=a.getChannelData(0);for(let h=0;h<i.length;h++)i[h]=(Math.random()-.5)*2;const s=.01,n=.1,o=.2,l=e-s-n;for(let h=0;h<i.length;h++){let c=h/t;c<s?i[h]*=c/s:c<s+n?i[h]*=1-(c-s)/n*(1-o):c>e-l&&(i[h]*=(e-c)/l)}for(let h=0;h<i.length;h++){let c=h/t;i[h]*=Math.sin(2*Math.PI*c*(440+Math.random()*100))}return a}generateSound(){const t=this.audioContext.sampleRate,e=.01,a=10,i=this.audioContext.createBuffer(1,t*e,t),s=i.getChannelData(0);for(let n=0;n<s.length;n++)s[n]=Math.sin(2*Math.PI*a*n/t);return i}generateExplosion(){const t=this.audioContext.sampleRate,e=.5,a=this.audioContext.createBuffer(1,t*e,t),i=a.getChannelData(0);for(let h=0;h<i.length;h++)i[h]=Math.random()*2-1;const s=.05,n=.2,o=0,l=e-s-n;for(let h=0;h<i.length;h++){let c=h/t;c<s?i[h]*=c/s:c<s+n?i[h]*=1-(c-s)/n*(1-o):c>e-l&&(i[h]*=(e-c)/l)}return a}playS1(){const t=this.audioContextSingleFire.createBufferSource();t.buffer=this.buffer1,t.connect(this.audioContextSingleFire.destination),t.start()}playS2(){const t=this.audioContextSingleFire.createBufferSource();t.buffer=this.buffer2,t.connect(this.audioContextSingleFire.destination),t.start()}startBgm(){this.bgmsource&&(this.bgmsource.stop(),this.bgmsource=null),this.bgmBuffer&&(this.bgmsource=this.audioContext.createBufferSource(),this.bgmsource.buffer=this.bgmBuffer,this.bgmsource.connect(this.audioContext.destination),this.bgmsource.loop=!0,this.bgmsource.start(0,this.pausedTime),this.startTime=this.audioContext.currentTime-this.pausedTime)}stopBgm(){this.bgmsource&&(this.pausedTime=this.audioContext.currentTime-this.startTime,this.bgmsource.stop(),this.bgmsource=null)}}class r{static EmptyCanv(){return this.makeCanvas()}static makeCanvas(t=0,e=0){let a=document.createElement("canvas");return a.width=t,a.height=e,a.w=t,a.h=e,a.ctx=a.getContext("2d")??new CanvasRenderingContext2D,a.center={x:t/2,y:e/2},a.clear=()=>{a.ctx.clearRect(0,0,t,e)},a.fill=i=>{a.ctx.fillStyle=i,a.ctx.fillRect(0,0,t,e)},a.fillPatern=i=>{const s=a.ctx.createPattern(i,"repeat");a.ctx!=null&&(a.ctx.fillStyle=s),a.ctx.fillRect(0,0,t,e)},a}static GenTable(t=0,e=0){var a="";for(let l=0;l<t;l++){a+="<tr>";for(let h=0;h<e;h++)a+="<td></td>";a+="</tr>"}var i=document.createElement("table");i.innerHTML=a;var s=[],n=i.querySelectorAll("tr");for(let l=0;l<n.length;l++){var o=n[l].querySelectorAll("td");s[l]=[...o]}return i.entities=s,i}static Point(t={x:0,y:0}){return new T(t)}static getEmojiSprite(t=" ",e=1,a=1.3,i="#000",s="sans-serif"){let n=r.makeCanvas(e,e);var o=n.ctx;return o.font=`${e/a}px ${s}`,o.textAlign="center",o.textBaseline="middle",o.fillStyle=i,o.fillText(t,e/2,e*1.1/2),n}static MakeRoundedRect(t=0,e=0,a=0,i="#000"){var s=r.makeCanvas(e,t),n=s.ctx,o=r.MakeCircle(t*a/100,null,i);return n.fillStyle=i,n.drawImage(o,0,0),n.drawImage(o,t-o.width,0),n.drawImage(o,t-o.width,e-o.height),n.drawImage(o,0,e-o.height),n.fillRect(o.width/2,1,t-o.width,e-2),n.fillRect(1,o.width/2,t-2,e-o.width),s}static getTextSprite(t=" ",e=1,a="#000",i=.8,s="sans-serif"){t=t.toUpperCase();let n=r.makeCanvas(e*t.length,e);for(let l=0;l<t.length;l++){var o=r.getEmojiSprite(t[l],e,i,a,s);n.ctx.drawImage(o,l*e,0)}return n}static GetTextSpriteWithShadow(t=" ",e=1,a="#000",i=.8,s="sans-serif",n="#fff"){var o=r.getTextSprite(t,e,a,i,s),l=r.getTextSprite(t,e,n,i,s),h=r.makeCanvas(o.w+4,o.w+4);return h.ctx.drawImage(l,1,1),h.ctx.drawImage(o,0,0),h}static fuseColor(t,e="#000"){var a=r.makeCanvas(t.w,t.h);return a.fill(e),r.fuseImage(t,a,"source-atop")}static fuseImage(t,e,a="source-atop"){if(!t||!e)return t;let i=r.makeCanvas(t.width,t.height),s=i.ctx;s.drawImage(t,0,0),s.globalCompositeOperation=a;for(let n=0;n<t.width/e.width;n++)for(let o=0;o<t.height/e.height;o++)s.drawImage(e,n*e.width,o*e.height);return i}static rotateCanvas(t,e=0){var a=e%90!=0?r.prepForRotate(t):t,i=r.makeCanvas(a.width,a.height),s=i.ctx;return s.save(),s.translate(i.width/2,i.height/2),s.rotate(e*Math.PI/180),s.drawImage(a,-a.width/2,-a.height/2),s.restore(),i}static prepForRotate(t){let e=Math.sqrt(Math.pow(t.width,2)+Math.pow(t.height,2)),a=r.makeCanvas(e,e);return a.ctx.drawImage(t,(e-t.width)/2,(e-t.height)/2),a}static mirror(t,e=!0){let a=r.makeCanvas(t.width,t.height),i=a.ctx;return i.save(),e?(i.scale(-1,1),i.drawImage(t,0,0,t.width*-1,t.height)):(i.scale(1,-1),i.drawImage(t,0,0,t.width,t.height*-1)),i.restore(),a}static gridBG(t="lightgrey",e=null,a=8,i=1){var s=r.makeCanvas(a,a),n=s.ctx;return n.fillStyle=t,n.fillRect(0,0,a,a),e==null?n.clearRect(0,0,a-i,a-i):(n.fillStyle=e,n.fillRect(0,0,a-i,a-i)),s}static Lightify(t,e=1){let a=r.makeCanvas(t.width,t.height);return a.ctx.globalAlpha=e,a.ctx.drawImage(t,0,0),a.ctx.globalAlpha=1,a}static makeDom(t){var e=document.createElement("div");return e.innerHTML=t,e.firstChild}static shuffleArray(t=[]){for(let e=t.length-1;e>0;e--){const a=Math.floor(Math.random()*(e+1));[t[e],t[a]]=[t[a],t[e]]}return t}static repeatCanvas(t,e=1,a=1){a==0&&(a=e);var i=r.makeCanvas(t.width*a,t.height*e),s=i.ctx.createPattern(t,"repeat");return i.ctx.fillStyle=s,i.ctx.fillRect(0,0,i.w,i.h),i}static merge(t=[],e=0,a=0){var i=r.makeCanvas(e,a);for(let s in t)i.ctx.drawImage(t[s],0,0);return i}static brickPattern(t="#fff",e="#000",a=1){var i=r.makeCanvas(8,8),s=i.ctx;return s.fillStyle=t,s.fillRect(0,0,i.width,i.height),s.fillStyle=e,s.fillRect(7,0,1,4),s.fillRect(0,3,8,1),s.fillRect(4,4,1,4),s.fillRect(0,7,8,1),a>1?r.repeatCanvas(i,a,a):i}static randomPattern(t="#000",e="#fff",a=.3,i=8,s=8){var n=r.makeCanvas(i,s),o=n.ctx;o.fillStyle=t,o.fillRect(0,0,n.width,n.height),o.fillStyle=e;for(let l=0;l<s;l++)for(let h=0;h<i;h++)Math.random()<a&&o.fillRect(h,l,1,1);return n}static MakeCircle(t=1,e=null,a=null,i=1){var s=r.makeCanvas(t*2+2,t*2+2),n=s.ctx;return n.save(),n.lineWidth=i,n.beginPath(),n.arc(s.width/2,s.height/2,t,0,Math.PI*2,!1),e!=null&&(n.strokeStyle=e,n.stroke()),a!=null&&(n.fillStyle=a,n.fill()),n.restore(),s}static movePointToward(t,e=0,a=0){const i=e*(Math.PI/180),s=a*Math.cos(i),n=a*Math.sin(i);return{x:t.x+s,y:t.y+n}}static loadImage(t="",e){var a=new Image;a.src=t,a.addEventListener("load",()=>{e(a)})}static getColor(t=0,e=0,a=0,i=0){return t+e+a+i==0?null:t+e+a==0||t>255||e>255||a>255?"#000000":"#"+((t<<16)+(e<<8)+a).toString(16).padStart(6,"0")}static getColorMatrix(t,e=null){var a=[];if(t.w<=1||t.h<=1)return a;for(var i=t.ctx,s=t.width,n=t.height,o=i.getImageData(0,0,s,n),l=o.data,h=[],c=0;c<l.length;c+=4)h.push(r.getColor(l[c],l[c+1],l[c+2],l[c+3]));for(let f=0;f<t.height;f++)a[f]=[];let d=0,p=0;for(let f=0;f<h.length;f++)d>=t.width&&(p++,d=0),a[p][d]=h[f],e&&(a[p][d]=e(a[p][d])),d++;return a}static imgToCanvas(t){var e=r.makeCanvas(t.width,t.height);return e.ctx.drawImage(t,0,0),e}static colorsMatrixToSprite(t,e=1,a=i=>i){let i=t.length,s=Math.max(...t.map(h=>h.length));var n=r.makeCanvas(s*e,i*e),o=n.ctx;for(let h=0;h<i;h++)for(let c=0;c<s;c++){var l=t[h][c];a&&(l=a(l)),!(!l||l=="")&&(o.fillStyle=l,o.fillRect(c*e,h*e,e,e))}return n}static magnify(t,e=1){var a=r.imgToCanvas(t),i=r.getColorMatrix(a,(s="")=>s);return r.colorsMatrixToSprite(i,e)}static crop(t,e=0,a=0,i=1,s=1){let n=r.makeCanvas(i,s);return n.ctx.drawImage(t,e,a,i,s,0,0,i,s),n}static randomColor(){for(var t="0123456789ABCDEF",e="#",a=0;a<6;a++)e+=t[Math.floor(Math.random()*16)];return e}static GenShadow(t,e=1,a="#000"){var i=r.makeCanvas(t.w,t.h);i.fill(a);var s=r.fuseImage(t,i,"source-atop"),n=r.makeCanvas(t.w+e,t.h+e);return n.ctx.drawImage(s,0,0,n.w,n.h),n}static NormGrid(t=0,e=0){return t/e*e+e/2}static GenBorder(t=1,e=1,a,i="#fff"){var s=r.makeCanvas(t,e);s.ctx.fillStyle=i,s.ctx.fillRect(a.w/2,a.h/2,s.w-a.w,s.h-a.h);for(var n=r.makeCanvas(s.w,a.h),o=r.makeCanvas(a.w,s.h),l=0,h=a;l<s.w-h.w;)n.ctx.drawImage(h,l,0),l+=h.w/2;for(var c=0;c<s.h-h.h;)o.ctx.drawImage(h,0,c),c+=h.h/2;return s.ctx.drawImage(n,0,-2),s.ctx.drawImage(n,0,s.h-n.h+2),s.ctx.drawImage(o,-1,0),s.ctx.drawImage(o,s.w-o.w+1,0),s}static GenerateCursor(){var t=r.makeCanvas(m,m),e=t.ctx;return e.fillStyle="#fff",e.fillRect(0,0,t.w,t.h),e.clearRect(2,2,t.w-4,t.h-4),e.clearRect(m/4,0,m/2,m),e.clearRect(0,m/4,m,m/2),t}static mapClick(t,e,a){var i=e.getBoundingClientRect();const s=e.width/i.width,n=e.height/i.height;var o=(t.clientX-i.left)*s+window.scrollX,l=(t.clientY-i.top)*n+window.scrollY;a(r.Point({x:o,y:l}))}static magnifyByMatrix(t,e=2){var a=r.getColorMatrix(t);return r.colorsMatrixToSprite(a,e)}static parseTime(t){let e=Math.floor(t/60),a=Math.floor(e/60);return e=Math.floor(e%60),t=Math.floor(t%60),`${a<10?0:""}${a}:${e<10?0:""}${e}:${t<10?0:""}${t}`}static rand(t=1,e=0){return e+(t-e)*Math.random()}static randInt(t=1,e=0){return r.rand(t,e)|0}}class I{black_cat;red_witch;mapBlueprint;dungeonprint1;constructor(t){t==null&&(t=r.makeCanvas(128,128));var e=r.imgToCanvas(t),a=r.getColorMatrix(e,(s="")=>s==""||s=="#fff"||s=="#ffffff"?null:s),i=r.colorsMatrixToSprite(a,1);this.black_cat=r.crop(i,0,0,32,32),this.red_witch=r.crop(i,32,0,32,32),this.mapBlueprint=r.crop(i,0,32,64,64),this.dungeonprint1=r.crop(i,0,80,16,16)}AnimateCat(){var t=r.imgToCanvas(this.black_cat),e=[],a={tail:[27,20,4,6],leftFoot:[7,29,8,3],rightFoot:[17,29,8,3],leftArm:[5,15,5,7],rightArm:[22,15,5,7]};function i(x){return r.crop(t,x[0],x[1],x[2],x[3])}var s=i(a.tail),n=r.mirror(s,!1),o=i(a.leftFoot),l=i(a.rightFoot),h=i(a.leftArm),c=r.mirror(h,!1),d=i(a.rightArm),p=r.mirror(d,!1);for(let x in a){let y=a[x];t.ctx.clearRect(y[0],y[1],y[2],y[3])}function f(x,y,M,S,A){var b=r.imgToCanvas(t);return b.ctx.drawImage(o,a.leftFoot[0],a.leftFoot[1]+(x?-2:0)),b.ctx.drawImage(l,a.rightFoot[0],a.rightFoot[1]+(y?-2:0)),M?b.ctx.drawImage(n,a.tail[0],a.tail[1]+4):b.ctx.drawImage(s,a.tail[0],a.tail[1]),S?b.ctx.drawImage(c,a.leftArm[0],a.leftArm[1]-4):b.ctx.drawImage(h,a.leftArm[0],a.leftArm[1]),A?b.ctx.drawImage(p,a.rightArm[0],a.rightArm[1]-4):b.ctx.drawImage(d,a.rightArm[0],a.rightArm[1]),b}var u=[{LF:0,RF:0,T:0,LA:0,RA:0},{LF:0,RF:0,T:0,LA:0,RA:0},{LF:1,RF:0,T:0,LA:0,RA:1},{LF:1,RF:0,T:1,LA:0,RA:0},{LF:0,RF:1,T:0,LA:1,RA:0},{LF:0,RF:1,T:1,LA:0,RA:0}];for(let x in u){var w=u[x],v=f(w.LF,w.RF,w.T,w.LA,w.RA);e.push(v)}return e}Cave(t=0,e=0){var a=r.makeCanvas(t,e),i=r.getEmojiSprite("ü™®",t,1.3);return a.ctx.drawImage(i,0,0),tt(a.ctx,"#000",a.w/1.6,a.h,a.w/4,a.h/3,0,0),a}static GenCozyWallTile(t=64){const e=r.makeCanvas(t,t),a=e.ctx;a.fillStyle="#e6d3b3",a.fillRect(0,0,t,t);const i=["#d1bfa3","#c2ad8f","#b8a07d","#e0ceb0"],s=3,n=4,o=t/n*.9,l=t/s*.7;for(let h=0;h<s;h++)for(let c=0;c<n;c++){let d=c*t/n+h%2*t/(n*2),p=h*t/s;a.beginPath(),a.ellipse(d+o/2,p+l/2,o/2,l/2,0,0,2*Math.PI),a.fillStyle=i[Math.floor(Math.random()*i.length)],a.shadowColor="#bba98a",a.shadowBlur=4,a.fill(),a.shadowBlur=0}return a.globalAlpha=.08,a.fillStyle="#fff",a.beginPath(),a.arc(t*.7,t*.3,t*.25,0,2*Math.PI),a.fill(),a.globalAlpha=1,e}static GenWaterTile(t=64,e=64){const a=r.makeCanvas(t,e),i=a.ctx;i.fillStyle="#639bff",i.fillRect(0,0,t,e);for(let s=0;s<t+e;s++){const n=r.randInt(0,t),o=r.randInt(0,e),l=r.randInt(2,6);i.globalAlpha=r.rand(.15,.35),i.fillStyle="#a3d8ff",i.beginPath(),i.arc(n,o,l,0,Math.PI*2),i.fill()}return i.globalAlpha=1,a}static GenDirtTile(t=64,e=64){const a=r.makeCanvas(t,e),i=a.ctx;i.fillStyle="#a67c52",i.fillRect(0,0,t,e);for(let s=0;s<t+e;s++){const n=r.randInt(0,t),o=r.randInt(0,e),l=r.randInt(2,5);i.globalAlpha=r.rand(.15,.35),i.fillStyle=r.rand()>.5?"#c2b280":"#7c5c36",i.beginPath(),i.arc(n,o,l,0,Math.PI*2),i.fill()}return i.globalAlpha=1,a}static GenGrassTile(t=64,e=64){const a=r.makeCanvas(t,e),i=a.ctx;i.fillStyle="#4caf50",i.fillRect(0,0,t,e);for(let s=0;s<t+e;s++){const n=r.randInt(0,t),o=r.randInt(0,e),l=r.randInt(2,5);i.globalAlpha=r.rand(.18,.38),i.fillStyle=r.rand()>.5?"#81c784":"#388e3c",i.beginPath(),i.arc(n,o,l,0,Math.PI*2),i.fill()}return i.globalAlpha=1,a}static GenWalkwayTile(t=64,e=64){const a=r.makeCanvas(t,e),i=a.ctx;i.fillStyle="#b0a99f",i.fillRect(0,0,t,e);const s=t/4,n=e/4;for(let o=0;o<4;o++)for(let l=0;l<4;l++){let h=l*s+(o%2===1?s/2:0);if(h+s>t)continue;let c=o*n;i.fillStyle=r.rand()>.5?"#d6d2c4":"#a59e91",i.fillRect(h,c,s-2,n-2),i.strokeStyle="#8d867a",i.lineWidth=1,i.strokeRect(h,c,s-2,n-2)}return i.globalAlpha=1,a}static GenFlowerGarden(t=64,e=64,a=8){var i=[r.getEmojiSprite("üåπ",12,1.3),r.getEmojiSprite("üå∑",12,1.3),r.getEmojiSprite("üåª",12,1.3),r.getEmojiSprite("üåº",12,1.3),r.getEmojiSprite("üå±",12,1.3)];const s=r.makeCanvas(t,e);var n=s.ctx,o=I.GenGrassTile(t,e);n.fillStyle="#4caf50",n.drawImage(o,0,0);for(let h=0;h<a;h++){const c=r.randInt(0,t-12),d=r.randInt(0,e-12);var l=i[r.randInt(0,i.length)];n.drawImage(l,c,d)}return s}}class T{x;y;constructor(t={x:0,y:0}){this.x=t.x,this.y=t.y}moveToward(t,e=1){var a=this.x==t.x?0:this.x<t.x?e:-e,i=this.y==t.y?0:this.y<t.y?e:-e;this.x+=a,this.y+=i}distance(t){let e=0;return e+=Math.pow(this.x-t.x,2),e+=Math.pow(this.y-t.y,2),e=Math.sqrt(e),e}getAngleTo(t){let e=t.x-this.x,a=t.y-this.y;return Math.atan2(a,e)*180/Math.PI}moveByAngle(t=0,e=0){const a=t*(Math.PI/180),i=e*Math.cos(a),s=e*Math.sin(a);this.x=this.x+i,this.y=this.y+s}}class ot{config;windowaspect;helpdom;layout=r.makeDom("");header=r.makeDom("");body=r.makeDom("");footer=r.makeDom("");player=new H({});constructor(){this.config={music:!1,sound:!1,controls:!1},this.resetBody(),this.preLoading(),this.windowaspect=window.innerHeight/window.innerWidth,this.windowaspect>1&&(m=32),B=Math.floor(window.innerWidth/m)-1,this.helpdom=document.createElement("div"),document.body.innerHTML=""}preLoading(){var t=r.makeDom("<div>Loading....</div>");this.body.append(t)}resetBody(){var t="<div class='_class_'></div>";this.layout=r.makeDom(t.replace("_class_","layout")),this.header=r.makeDom(t.replace("_class_","header")),this.body=r.makeDom(t.replace("_class_","body")),this.footer=r.makeDom(t.replace("_class_","footer")),this.layout.appendChild(this.header),this.layout.appendChild(this.body),this.layout.appendChild(this.footer),document.body.innerHTML="",document.body.appendChild(this.layout)}prepFootercontrols(){if(this.config.controls==!1){this.footer.innerHTML="";return}this.footer.innerHTML="";var t=r.GenTable(2,3);t.classList.add("gamecontrolstable"),t.style.width=B*m+"px";var e=t.entities,a=[{html:"<span> <h1>w</h1> </span>",f:"w",r:0,c:1},{html:"<span> <h1>s</h1> </span>",f:"s",r:1,c:1},{html:"<span> <h1>a</h1> </span>",f:"a",r:0,c:0},{html:"<span> <h1>d</h1> </span>",f:"d",r:0,c:2}];a.forEach(i=>{var s=r.makeDom(i.html);e[i.r][i.c].addEventListener("touchstart",()=>this.player.keys.keydown(i.f)),e[i.r][i.c].addEventListener("touchend",()=>this.player.keys.keyup(i.f)),e[i.r][i.c].addEventListener("mousedown",()=>this.player.keys.keydown(i.f)),e[i.r][i.c].addEventListener("mouseup",()=>this.player.keys.keyup(i.f)),e[i.r][i.c].append(s),e[i.r][i.c].style.border="2px solid black",e[i.r][i.c].style.background="blue",e[i.r][i.c].style.color="#fff"}),e[0][2].rowSpan=2,e[1][2].remove(),e[0][0].rowSpan=2,e[1][0].remove(),this.footer.appendChild(t)}}class H{game;xp;level;spellpower;speed;visibility;cat;catIdleAnimation;catWalkAnimation;animation;center;pos;sprite;moving;destination;pathplan;keys;constructor(t){this.game=t,this.xp=0,this.level=0,this.spellpower=[{k:"m",e:"üîÆ",v:1},{k:"f",e:"üî•",v:1},{k:"w",e:"üíß",v:1},{k:"e",e:"üå±",v:1},{k:"i",e:"üå™Ô∏è",v:1},{k:"z",e:"‚ö°",v:1},{k:"l",e:"‚òÄÔ∏è",v:1},{k:"d",e:"üåë",v:1}],this.speed=2,this.visibility=m*4,this.cat=new $(t),this.catIdleAnimation=this.cat.IdleAnimation(),this.catWalkAnimation=this.cat.WalkingAnimation(),this.animation={framerate:8,frame:0,spriteindex:0,spritesheet:this.catIdleAnimation},this.center=new T({x:3*m-m/2,y:5*m-m/2}),this.pos=r.Point(this.center),this.sprite=this.catIdleAnimation[0],this.moving=!1,this.destination=r.Point(this.center),this.pathplan=[]}update(){if(this.animation.spritesheet=this.moving?this.catWalkAnimation:this.catIdleAnimation,this.animation.frame++,this.animation.frame>=this.animation.framerate&&(this.animation.spriteindex>=this.animation.spritesheet.length&&(this.animation.spriteindex=0),this.sprite=this.animation.spritesheet[this.animation.spriteindex],this.animation.spriteindex++,this.animation.frame=0),this.destination.distance(this.center)>=this.speed?this.center.moveToward(this.destination,this.speed):(this.center=r.Point(this.destination),this.moving=!1),this.destination.distance(this.center)==0&&this.pathplan.length>0){var t=this.pathplan.shift();this.destination=r.Point(t),this.moving=!0}}draw(t){t.drawImage(this.sprite,this.center.x-this.sprite.w/2,this.center.y-this.sprite.h/2)}getCameraStartXY(){var t=Math.max(0,this.center.x-this.game.canvasDim.w/2),e=Math.max(0,this.center.y-this.game.canvasDim.h/2);return{x:t,y:e}}handleTouchPos(t){if(!(t.y<m)){var e=this.getCameraStartXY(),a={i:Math.floor(r.NormGrid(e.x+t.x,m)/m),j:Math.floor(r.NormGrid(e.y+t.y,m)/m)};if(this.moving==!1){var i=this.game.gamemap;if(!i.isObstacle(a)){var s={i:Math.floor(this.center.x/m),j:Math.floor(this.center.y/m)};this.pathplan=i.findPathNormPt(s,a)}}}}}class D{coordinates;objects;score;constructor(){this.coordinates=new Set,this.objects=[],this.score=0}length(){return this.objects.length}removeLast(){var t=this.objects.pop();const e=JSON.stringify(t);this.coordinates.delete(e),this.score=this.getSquenceScore()}getLast(){if(this.objects.length>0)return this.objects[this.objects.length-1]}getbeforeLast(){if(this.objects.length>1)return this.objects[this.objects.length-2]}add(t){const e=JSON.stringify(t);return this.coordinates.has(e)?!1:(this.coordinates.add(e),this.objects.push(t),!0)}has(t){return this.coordinates.has(JSON.stringify(t))}getAll(){return[...this.objects]}getSequence(){var t=this.objects.map(e=>e.val);return t.length==0?" ":t.join("")}getSquenceScore(){return 0}}class E{attrib;x=0;y=0;shadow=r.EmptyCanv();canvas=r.EmptyCanv();constructor(t){this.updateCanvas(t)}updateCanvas(t){var e=r.makeCanvas(t.w,t.h),a=e.ctx;e.fill(t.color);var i=r.getTextSprite(t.name,14,"#000",1.1);a.drawImage(t.sprite,e.w/2-t.sprite.w/2,e.h/2-t.sprite.h/2),a.drawImage(i,e.w/2-i.w/2,4),a.fillStyle=t.health/t.healthmax>.4?"green":"red",a.fillRect(m/5,i.h+4,(e.w-m/10)*(t.health/t.healthmax),4),this.x=t.x,this.y=t.y,this.shadow=r.makeCanvas(t.w+4,t.h+4),this.shadow.fill(t.shadow),this.canvas=e}draw(t){t.drawImage(this.shadow,this.x-2,this.y-2),t.drawImage(this.canvas,this.x,this.y)}}class ht{game;canvasDim;w;h;x;y;rows;cols;currentgamecanvas;player;mob;blocksize;ambient;endscenefct;tilesize;canvas;isClick;markedCenters;roundRectS1;roundRectS2;combatlogo;arrowSprite;explosionsprite;menuclickables;playercardattrib;mobcardattrib;cards;elementals;touchPos;currentPointer;grid=[];constructor(t,e=null,a=null,i="",s){t.body.innerHTML="",this.game=t,this.canvasDim=t.canvasDim,this.w=this.canvasDim.w,this.h=this.canvasDim.h,this.currentgamecanvas=r.imgToCanvas(t.canvas),this.player=e,this.mob=a,this.ambient=this.getAmbient(i),this.endscenefct=s,this.blocksize=m*1.85,this.tilesize=this.blocksize*.82,this.canvas=r.makeCanvas(this.w,this.h),t.body.append(this.canvas),this.isClick=!1,this.markedCenters=new D,this.roundRectS1=r.MakeRoundedRect(this.tilesize,this.tilesize,12.5,"#fff"),this.roundRectS2=r.MakeRoundedRect(this.tilesize,this.tilesize,12.5,"#8c8c8c"),this.combatlogo=r.getEmojiSprite("‚öî",m*3,1.3,"#fff"),this.arrowSprite=r.getEmojiSprite("‚û°",this.tilesize,1.3,"#fff"),this.explosionsprite=r.getEmojiSprite("üí•",this.tilesize,1.3,"#fff"),this.menuclickables=[new F(0,0,m*1.5,m*1.5,r.getEmojiSprite("üö™",m*1.5,1.4),()=>{s&&s(this)})],this.playercardattrib={name:"player",health:90,healthmax:100,sprite:r.magnify(t.spriteEngine.black_cat,2),x:m*3,y:this.canvas.h/5,w:m*3,h:m*3.5,color:"gold",shadow:"#fff"},this.mobcardattrib={name:"target",health:33,healthmax:100,sprite:r.getEmojiSprite("üßü",64,1.3),x:this.canvas.w-m*3-m*3,y:this.canvas.h/5,w:m*3,h:m*3.5,color:"gold",shadow:"#fff"},this.cards=[new E(this.playercardattrib),new E(this.mobcardattrib)],this.elementals=[{v:"m",e:"üîÆ",s:this.getSprite("üîÆ",!1),sd:this.getSprite("üîÆ",!0),c:"#f00"},{v:"f",e:"üî•",s:this.getSprite("üî•",!1),sd:this.getSprite("üî•",!0),c:"#f00"},{v:"w",e:"üíß",s:this.getSprite("üíß",!1),sd:this.getSprite("üíß",!0),c:"#00f"},{v:"e",e:"üå±",s:this.getSprite("üå±",!1),sd:this.getSprite("üå±",!0),c:"#0a0"},{v:"i",e:"üå™Ô∏è",s:this.getSprite("üå™Ô∏è",!1),sd:this.getSprite("üå™Ô∏è",!0),c:"#aaa"},{v:"z",e:"‚ö°",s:this.getSprite("‚ö°",!1),sd:this.getSprite("‚ö°",!0),c:"#ff0"},{v:"l",e:"‚òÄÔ∏è",s:this.getSprite("‚òÄÔ∏è",!1),sd:this.getSprite("‚òÄÔ∏è",!0),c:"#ffb"},{v:"d",e:"üåë",s:this.getSprite("üåë",!1),sd:this.getSprite("üåë",!0),c:"#555"}],this.x=0,this.y=this.canvas.h/2,this.rows=Math.floor(this.canvas.h/this.blocksize/2),this.cols=Math.floor(this.canvas.w/this.blocksize),this.touchPos=null,this.canvas.addEventListener("mousedown",()=>o()),this.canvas.addEventListener("mouseup",h=>n(h)),this.canvas.addEventListener("mousemove",h=>l(h)),this.canvas.addEventListener("touchstart",()=>o()),this.canvas.addEventListener("touchend",h=>n(h)),this.canvas.addEventListener("touchmove",h=>l(h));var n=h=>{if(this.touchPos=null,this.markedCenters.objects.length>0){var c=this.markedCenters.getSequence(),d=z.find(f=>f.i==c);if(d)if(d.isattack)this.markedCenters.objects.forEach(f=>{this.grid[f.r][f.c].val=0}),this.grid=this.applyGravity(this.grid,this.rows,this.cols,f=>f.val==0,(f,u)=>this.getNewEntity(f,u)),this.resetGridCenters(this.grid),this.mobcardattrib.health-=d.dmg,this.cards=[new E(this.playercardattrib),new E(this.mobcardattrib)];else{var p=this.markedCenters.getLast();this.markedCenters.objects.forEach(f=>{this.grid[f.r][f.c].val=0}),p.val=d.r,p.sprite=this.elementals.find(f=>f.v==d.r)?.s,this.grid=this.applyGravity(this.grid,this.rows,this.cols,f=>f.val==0,(f=0,u=0)=>this.getNewEntity(f,u)),this.resetGridCenters(this.grid),this.playercardattrib.health-=5,this.cards=[new E(this.playercardattrib),new E(this.mobcardattrib)]}}this.isClick=!1,this.markedCenters=new D,r.mapClick(h.touches?h.touches[0]:h,this.canvas,f=>{this.menuclickables.forEach(u=>{u.handleTouchPos&&u.handleTouchPos(f)})})},o=()=>{this.isClick=!0},l=h=>{r.mapClick(h.touches?h.touches[0]:h,this.canvas,c=>{var d=new T(c),p=this.grid.flat().find(v=>d.distance(v.center)<this.blocksize/2);if(p!=null){var f=this.currentPointer=p.center;if(this.isClick){var u=this.markedCenters.getLast(),w=this.markedCenters.getbeforeLast();u==null||u==null?this.markedCenters.add(p):w!=null&&f.distance(w.center)<this.blocksize/2?this.markedCenters.removeLast():f.distance(u.center)<this.blocksize*1.5&&this.markedCenters.add(p)}}})};this.newBoard(),this.update()}getAmbient(t){var e=r.makeCanvas(this.w,this.h);if(t!="dungeon"){var a=I.GenFlowerGarden(this.w,this.h,this.w);e.ctx.drawImage(a,0,0);var i=r.getEmojiSprite("üå≥",this.w/2,1.2);e.ctx.drawImage(i,-i.w/2,0),e.ctx.drawImage(i,this.w-i.w/2,0)}return r.Lightify(e,.5)}applyGravity(t,e=0,a=0,i,s,n=!0){if(t.flat().find(o=>i(o))==null)return t;for(let o=0;o<a;o++){const l=[];for(let h=0;h<e;h++)i(t[h][o])||l.push(t[h][o]);if(n)for(let h=0;h<e;h++)t[h][o]=h>=e-l.length?l[h-(e-l.length)]:s(h,o);else for(let h=0;h<e;h++)t[h][o]=h<l.length?l[h]:s(h,o)}return this.applyGravity(t,e,a,i,s,n)}resetGridCenters(t){for(let s=0;s<t.length;s++)for(let n=0;n<t[s].length;n++){var e=this.x+n*this.blocksize+this.blocksize/2,a=this.y+s*this.blocksize+this.blocksize/2,i=new T({x:e,y:a});t[s][n].center=i,t[s][n].r=s,t[s][n].c=n}}getNewEntity(t=0,e=0){var a=this.x+t*this.blocksize+this.blocksize/2,i=this.y+e*this.blocksize+this.blocksize/2,s=new T({x:a,y:i}),n=this.elementals[r.randInt(0,this.elementals.length)];return{center:s,val:n.v,sprite:n.s}}getGussingWordSprite(){var t=this.markedCenters.getSequence(),e=this.tilesize,a=this.tilesize;if(t==" ")return r.makeCanvas();var i={};this.elementals.forEach(c=>i[c.v]=c.s);var s=z.find(c=>c.i==t);if(s){var n=r.makeCanvas(t.length*e+e*2,a);n.fill("green");var o=0;for(let c=0;c<t.length;c++){var l=t[c];i[l]&&n.ctx.drawImage(i[l],o,0),o+=e}if(s.dmg){n.ctx.drawImage(this.arrowSprite,o,0),o+=e;var h=r.fuseImage(this.explosionsprite,i[s.r],"source-atop");n.ctx.drawImage(h,o,0),o+=e}else n.ctx.drawImage(this.arrowSprite,o,0),o+=e,n.ctx.drawImage(i[s.r],o,0),o+=e;return n}else{var n=r.makeCanvas(t.length*e,a);n.fill("red");var o=0;for(let p=0;p<t.length;p++){var l=t[p];i[l]&&n.ctx.drawImage(i[l],o,0),o+=e}return n}}getSprite(t=" ",e=!1){var a=r.getEmojiSprite(t,this.tilesize,1.3);return e?r.fuseImage(this.roundRectS1,a):r.fuseImage(this.roundRectS2,a)}update(){if(this.mobcardattrib.health<=0){this.endscenefct(this);return}var t=this.canvas.ctx;this.canvas.fill("#000"),t.drawImage(this.ambient,0,0),t.fillStyle="#fff",t.drawImage(this.combatlogo,this.canvas.w/2-this.combatlogo.w/2,this.canvas.h/5-this.combatlogo.h);var e=this.markedCenters.getAll();if(e.length>1){var a=this.getGussingWordSprite();t.drawImage(a,this.x+this.w/2-a.w/2,this.y-this.blocksize),t.strokeStyle="#fff",t.lineWidth=this.blocksize/6,t.beginPath(),t.moveTo(e[0].center.x,e[0].center.y);for(let c=1;c<e.length;c++)t.lineTo(e[c].center.x,e[c].center.y);t.stroke()}for(let c=0;c<this.rows;c++)for(let d=0;d<this.cols;d++){var i=this.grid[c][d],s=!1;(c%2==0||d%2==0)&&!(c%2==0&&d%2==0)&&(s=!0);var n=this.elementals.find(p=>p.v==i.val);if(n){var o=s?n.sd:n.s,l=i.center.x-o.w/2,h=i.center.y-o.h/2;t.drawImage(o,l,h)}}this.cards.forEach(c=>c.draw(t)),this.menuclickables.forEach(c=>c.draw(this.canvas.ctx)),requestAnimationFrame(()=>this.update())}newBoard(){this.currentPointer={x:-1/0,y:-1/0},this.markedCenters=new D;var t=[];for(let n=0;n<this.rows;n++){t[n]=[];for(let o=0;o<this.cols;o++){var e=this.x+o*this.blocksize+this.blocksize/2,a=this.y+n*this.blocksize+this.blocksize/2,i=new T({x:e,y:a}),s=this.elementals[r.randInt(0,this.elementals.length)];t[n][o]={r:n,c:o,center:i,val:s.v,sprite:s.s}}}this.grid=t}}class ct{game;portal;player;playeroldpos;constructor(t,e,a){this.game=t,this.portal=e,this.player=a,this.playeroldpos=r.Point(a.center),t.body.innerHTML="dungeon scene under construction, visit pdemia.com/bcg for updates ^_^ ....";var i=r.makeDom("<button>back</button>");i.onclick=()=>{t.body.innerHTML="",t.body.append(t.canvas),t.gamePased=!1,t.dialog.remove(),t.update(t.time)},t.body.append(i)}update(){}}class lt{game;maingamescene;canvas;menuclickables;isClick=!1;constructor(t){this.game=t,t.body.innerHTML="",t.body.append(t.canvas),t.gamePased=!1,t.dialog.remove(),this.maingamescene=r.imgToCanvas(t.canvas),this.canvas=r.imgToCanvas(t.canvas);var e=this.canvas.w,a=this.canvas.h;t.body.innerHTML="",t.body.append(this.canvas);var i=this.canvas.ctx;this.menuclickables=[];var s=r.getTextSprite("‚ñ©",16,"#c3c139",1.3),n=r.GenBorder(e,a/2,s,"#e7e570");i.drawImage(n,0,0);var o=r.GenBorder(64,64,s,"#c3c139"),l=r.getEmojiSprite("üßô",64,1.3);i.drawImage(o,e-o.w-16,16),i.drawImage(l,e-o.w-16,16);var h=[r.GetTextSpriteWithShadow("Hello? .....",16,"#7a7818",1,"cursive"),r.GetTextSpriteWithShadow("Portals appear, monsters...",16,"#7a7818",1,"cursive"),r.GetTextSpriteWithShadow("your master is lost in one of them",16,"#7a7818",1,"cursive"),r.GetTextSpriteWithShadow("your mission ... rescue master",16,"#7a7818",1,"cursive"),r.GetTextSpriteWithShadow("Game is under construction",16,"#00f",1,"cursive"),r.GetTextSpriteWithShadow("JS13k competition 2025",16,"#00f",1,"cursive")],c=m;for(let v in h)i.drawImage(h[v],m,c),c+=m;var d=r.GetTextSpriteWithShadow("OK",16,"#7a7818",1,"cursive"),p=r.GenBorder(d.w+m,d.h+m,s,"#e7e570");p.ctx.drawImage(d,m/2,m/2),this.menuclickables.push(new F(m*1.5,c,p.w,p.h,p,()=>{t.body.innerHTML="",t.body.append(t.canvas),t.gamePased=!1,t.dialog.remove(),t.update(t.time)})),this.menuclickables.forEach(v=>{v.draw(i)}),this.canvas.addEventListener("mousedown",()=>u()),this.canvas.addEventListener("mouseup",v=>f(v)),this.canvas.addEventListener("mousemove",v=>w(v)),this.canvas.addEventListener("touchstart",()=>u()),this.canvas.addEventListener("touchend",v=>f(v)),this.canvas.addEventListener("touchmove",v=>w(v));var f=v=>{r.mapClick(v.touches?v.touches[0]:v,this.canvas,x=>{this.menuclickables.forEach(y=>{y.handleTouchPos&&y.handleTouchPos(x)})})},u=()=>{this.isClick=!0},w=v=>{r.mapClick(v.touches?v.touches[0]:v,this.canvas,()=>{})}}}class q extends ot{spriteEngine=new I(null);cellSize=0;objects=[];canvasDim;canvas=r.makeCanvas();gamemap=null;gamePased=!1;dialog=r.makeDom("");time=0;healthdom=r.makeDom("");pointsdom=r.makeDom("");leveldom=r.makeDom("");timedom=r.makeDom("");gameover=!0;player={};portals=[];menuclickables=[];scene=null;events={};touchPos={};SoundSystem=null;constructor(){super(),this.canvasDim={w:600,h:600},r.loadImage("sh1.gif?"+Math.random(),t=>{this.cellSize=m,this.spriteEngine=new I(t),this.objects=[],this.mainScene()})}prepheader(){var t=r.GenTable(2,6);t.style.width=this.canvasDim.w+"px";var e=t.entities;this.healthdom=document.createElement("div"),this.pointsdom=document.createElement("div"),this.leveldom=document.createElement("div"),this.timedom=document.createElement("div"),e[0][5].rowSpan=2,e[0][5].append(r.getEmojiSprite("üìã",40,1.4)),e[1][5].remove(),e[0][5].onclick=()=>{this.showMenu()},this.header.append(t)}mainScene(){this.gameover=!0,this.gamePased=!0,this.resetBody(),this.canvas=r.makeCanvas(this.canvasDim.w,this.canvasDim.h),this.canvas.fill("#000"),this.getMainMenuBg(this.canvas),this.body.append(this.canvas),this.showMenu()}showMenu(){this.gamePased=!0,this.dialog!=null&&this.dialog.remove(),this.dialog=Object.assign(document.createElement("div"),{className:"menuDialog"});var t=[];this.gameover?(t.push({html:"<button >New Game</button>",f:"newgame"}),t.push({html:"<button >Practice Combat</button>",f:"paracticecombat"})):t.push({html:"<button >Resume</button>",f:"resume"}),t.push({html:"<button> About </button>",f:"about"},{html:`<button >Music ${this.config.music?"ON":"OFF"}</button>`,f:"music"}),this.gameover||t.push({html:"<button >Quit</button>",f:"quit"});var e=r.GenTable(t.length,1);for(let i in t){var a=r.makeDom(t[i].html);e.entities[i][0].append(a),e.entities[i][0].onclick=()=>{this.ApplyMenuItem(t[i].f)}}this.dialog.append(e),this.body.append(this.dialog)}newGame(){this.resetBody(),this.body.innerHTML="",this.gamemap=new st(this),this.portals=this.gamemap.locations_portal.map(i=>new at(this,i)),this.canvas=r.makeCanvas(this.canvasDim.w,this.canvasDim.h),this.body.innerHTML="",this.body.appendChild(this.canvas),this.body.appendChild(this.helpdom),this.player=new H(this),this.menuclickables=[new F(0,0,m*1.5,m*1.5,r.getEmojiSprite("üìã",m*1.5,1.4),()=>{this.showMenu()})],this.objects=[this.player,...this.portals],this.body.innerHTML="",this.body.appendChild(this.canvas),this.body.appendChild(this.helpdom),this.update(0),this.scene=new lt(this),this.events={touchstart:!1},this.touchPos=null,this.canvas.addEventListener("mousedown",i=>e(i)),this.canvas.addEventListener("mouseup",()=>t()),this.canvas.addEventListener("mousemove",i=>a(i)),this.canvas.addEventListener("touchstart",i=>e(i)),this.canvas.addEventListener("touchend",()=>t()),this.canvas.addEventListener("touchmove",i=>a(i));var t=()=>{this.touchPos=null},e=i=>{r.mapClick(i.touches?i.touches[0]:i,this.canvas,s=>{var n=s.x,o=s.y;this.touchPos={x:n,y:o}})},a=i=>{this.touchPos&&r.mapClick(i.touches?i.touches[0]:i,this.canvas,s=>{var n=s.x,o=s.y;this.touchPos={x:n,y:o}})}}ApplyMenuItem(t){if(t=="newgame")this.gamePased=!1,this.gameover=!1,this.newGame();else if(t=="resume")this.gamePased=!1,this.dialog.remove(),this.update(this.time);else if(t=="music"){this.SoundSystem||(this.SoundSystem=new nt);var e=this.config.music;e?this.SoundSystem.stopBgm():this.SoundSystem.startBgm(),this.config.music=!this.config.music,this.dialog.remove(),this.showMenu()}else if(t=="quit")document.fullscreenEnabled&&document.exitFullscreen(),this.gamePased=!0,this.gameover=!0,this.dialog.remove(),this.mainScene();else if(t=="about"){this.dialog!=null&&this.dialog.remove(),this.dialog=Object.assign(document.createElement("div"),{className:"menuDialog"}),this.dialog.style.width=`${B*m}px`;var a=`
                <div class="helpDiv" color='#fff'>
                    <h1>GAME STILL UNDER CONSTRUCTION</h1>
                    <h3>entry in js13k games 2025</h3>
                    <h3>visit <a href="https://pdemia.com/bcg">pdemia.com/bcg<a> for updates</h3>
                    <h3>last update 12/9/2025 </h3>
                    <p>mohammad0jawad@gmail.com</p>
                </div>
            `,i=r.makeDom("<button>Back</button>");i.onclick=()=>{this.gamePased=!1,this.dialog.remove(),this.showMenu()},this.dialog.innerHTML+=a,this.dialog.append(i),this.body.append(this.dialog)}else t=="paracticecombat"&&(this.gamePased=!0,this.dialog.remove(),this.scene=new ht(this,null,null,"garden",()=>{console.log("combat training over"),this.scene=null,this.gamePased=!0,this.gameover=!0,this.dialog.remove(),this.mainScene()}))}parseNum(t){return t>=1e10?`${(t/1e10).toFixed(1)}T`:t>=1e8?`${(t/1e8).toFixed(1)}B`:t>=1e6?`${(t/1e6).toFixed(1)}M`:t>=1e3?`${(t/1e3).toFixed(1)}k`:`${t}`}updateBuffer(){var t=this.gamemap,e=t.map,a=e.ctx;this.player.draw(a);var i=this.player.getCameraStartXY(),s=r.crop(e,i.x,i.y,this.canvasDim.w,this.canvasDim.h);return s}gameOverScene(){}update(t=0){if(this.gamePased!=!0){if(this.gameover==!0)return this.gameOverScene();this.objects.forEach(o=>o.update(t));var e=this.gamemap?.getMap()??r.EmptyCanv(),a=e.ctx;this.objects.sort((o,l)=>o.pos?o.pos?.y:1/0-l.pos?l.pos?.y:1/0),this.objects.forEach(o=>o.draw(a));var i=Math.max(0,this.player.center.x-this.canvasDim.w/2),s=Math.max(0,this.player.center.y-this.canvasDim.h/2),n=r.crop(e,i,s,this.canvasDim.w,this.canvasDim.h);this.canvas.fill("#88bfff"),this.canvas.ctx.drawImage(n,0,0),this.canvas.ctx.fillRect,this.menuclickables.forEach(o=>o.draw(this.canvas.ctx)),this.touchPos&&(this.objects.forEach(o=>{o.handleTouchPos&&o.handleTouchPos(this.touchPos)}),this.menuclickables.forEach(o=>{o.handleTouchPos&&o.handleTouchPos(this.touchPos)}),this.touchPos=null),this.time=t,requestAnimationFrame(o=>this.update(o))}}openPortalMenu(t){this.dialog!=null&&this.dialog.remove(),this.dialog=Object.assign(document.createElement("div"),{className:"menuDialog"});var e=r.makeDom(`<div><h3>Portal Level ${t.level}<h3></div>`);e.style.height=this.canvas.height/2+"px",this.dialog.append(e);var a=r.GenTable(2,1);a.entities[0][0].innerHTML="<button >Enter</button>",a.entities[0][0].onclick=()=>{this.dialog.remove(),this.gamePased=!0,this.scene=new ct(this,t,this.player)},a.entities[1][0].innerHTML="<button >Leave</button>",a.entities[1][0].onclick=()=>{this.dialog.remove()},this.dialog.append(a),this.body.append(this.dialog)}getMainMenuBg(t){var e=new mt(this);e.draw(t);function a(){e.update(),e.draw(t),requestAnimationFrame(a)}requestAnimationFrame(a)}}class mt{game;cat;credit;catIdle;catIdleShadow;canvas;catInBox;catWalkAnimation;catWalkAnimationShadow;catAnimations64;space;rotspeed;elements;circlesprite;pointsprite;circlepoints;circle;LogoY;CatWalkingAnimationObj;familiarSprite;constructor(t){this.game=t,this.cat=new $(t),this.credit=r.getTextSprite("BY MHMDJAWADZD",16,"#fff",1.5,"cursive"),this.catIdle=this.cat.Idle(),this.catIdleShadow=r.GenShadow(this.catIdle,2,"#fff"),this.catIdleShadow.ctx.drawImage(this.catIdle,1,1),this.canvas=r.makeCanvas(t.canvasDim.w,t.canvasDim.h),this.catInBox=r.magnifyByMatrix(this.catIdleShadow,2),this.catWalkAnimation=this.cat.WalkingAnimation(),this.catWalkAnimationShadow=this.catWalkAnimation.map(i=>r.GenShadow(i,2,"#fff")),this.catWalkAnimationShadow.forEach((i,s)=>i.ctx.drawImage(this.catWalkAnimation[s],1,1)),this.catAnimations64=this.catWalkAnimationShadow.map(i=>r.magnifyByMatrix(i,2)),this.space=r.randomPattern("#000","#fff",.001,this.canvas.w*3,this.canvas.h),this.rotspeed=5,this.elements=[{s:r.getEmojiSprite("üî•",32,1.3),c:"#ee4000c7",i:0,t:this.rotspeed},{s:r.getEmojiSprite("üíß",32,1.3),c:"#00c7eec7",i:10,t:this.rotspeed},{s:r.getEmojiSprite("üå±",32,1.3),c:"#805a05c7",i:20,t:this.rotspeed},{s:r.getEmojiSprite("üå™Ô∏è",32,1.3),c:"#cdcf84c7",i:30,t:this.rotspeed},{s:r.getEmojiSprite("‚ö°",32,1.3),c:"#f9ff30c7",i:40,t:this.rotspeed},{s:r.getEmojiSprite("‚òÄÔ∏è",32,1.3),c:"#f8ff00c7",i:50,t:this.rotspeed},{s:r.getEmojiSprite("üåë",32,1.3),c:"#a83bf3c7",i:60,t:this.rotspeed}],this.circlesprite=r.MakeCircle(m*4,"#fff",null,3),this.pointsprite=r.MakeCircle(m/9,"#00f","#00f",3);var e=this.canvas.h-this.circlesprite.h/2-m,a={x:this.canvas.w/2,y:e,r:this.circlesprite.w/2};this.circlepoints=et(a.x,a.y,a.r,70),this.circle=a,this.LogoY=e-this.circlesprite.h/2-m,this.CatWalkingAnimationObj={sprites:this.catAnimations64,current:0,frames:0,framerate:16,locX:64,locY:this.LogoY},this.GenFamiliarSprite()}GenFamiliarSprite(){var t=["T","H","E"," ","F","A","M","I","L","I","A","R"],e=r.makeCanvas(64*t.length,m+4),a=0;for(let n in t){var i=r.getTextSprite(t[n],m,"#fff",1.1,"cursive"),s=r.getTextSprite(t[n],m,"#b90000",1.1,"cursive");e.ctx.drawImage(i,a+1,1),e.ctx.drawImage(s,a,0),a+=m}this.familiarSprite={sprite:e,locX:128,locY:this.LogoY,currentShowing:0}}draw(t){t.ctx.drawImage(this.canvas,0,0)}update(){var t=r.randInt(0,this.space.w-this.canvas.w);this.canvas.ctx.drawImage(this.space,0,0,t,this.canvas.h,0,0,this.canvas.w,this.canvas.h),this.canvas.ctx.drawImage(this.circlesprite,this.circle.x-this.circlesprite.w/2,this.circle.y-this.circlesprite.h/2),this.canvas.ctx.drawImage(this.CatWalkingAnimationObj.sprites[this.CatWalkingAnimationObj.current],this.circle.x-32,this.circle.y-32),this.CatWalkingAnimationObj.frames++,this.CatWalkingAnimationObj.frames>this.CatWalkingAnimationObj.framerate&&(this.CatWalkingAnimationObj.frames=0,this.CatWalkingAnimationObj.current++,this.CatWalkingAnimationObj.current>=this.CatWalkingAnimationObj.sprites.length&&(this.CatWalkingAnimationObj.current=0)),this.canvas.ctx.drawImage(this.familiarSprite.sprite,0,0,this.familiarSprite.currentShowing,this.familiarSprite.sprite.h,this.familiarSprite.locX,this.familiarSprite.locY,this.familiarSprite.currentShowing,this.familiarSprite.sprite.h),this.familiarSprite.currentShowing+=4,this.familiarSprite.currentShowing>this.familiarSprite.sprite.w&&(this.familiarSprite.currentShowing=0),this.elements.forEach(e=>{var a=this.circlepoints[e.i%this.circlepoints.length];this.canvas.ctx.drawImage(e.s,a.x-e.s.w/2,a.y-e.s.h/2);var i=this.elements.filter(n=>n!=e)[r.randInt(this.elements.length-1)],s=this.circlepoints[i.i%this.circlepoints.length];this.canvas.ctx.save(),this.canvas.ctx.strokeStyle=e.c,this.canvas.ctx.lineWidth=2,this.canvas.ctx.beginPath(),this.canvas.ctx.moveTo(a.x,a.y),this.canvas.ctx.lineTo(s.x,s.y),this.canvas.ctx.stroke(),this.canvas.ctx.restore(),e.t--,e.t<=0&&(e.t=this.rotspeed,e.i++)}),this.canvas.ctx.drawImage(this.credit,0,this.canvas.h-this.credit.h)}}if(!window.game)try{window.game=new q}catch{setTimeout(()=>{window.game=new q},0)}
