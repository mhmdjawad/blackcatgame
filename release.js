let m=32;
var q={Bb:[{g:[0,0,140,0,0,0,140,0,0,255,158,158,158,0,0,0,0,51,2,1,2,58,239,0,32,88,1,157,2],p:[1,1,1,1],c:[{n:[161,,,,,,,,,,,,,,,,163,,,,,,,,159],f:[]}]},{g:[0,91,128,0,0,95,128,12,0,0,12,0,72,0,0,0,0,0,0,0,2,255,0,0,32,83,3,130,4],p:[1,1,2,1],c:[{n:[144,,151,,149,,147,,146,,147,,146,,144,,144,,151,,149,,147,,146,,147,,146,,144],f:[]},{n:[156,,163,,161,,159,,158,,159,,158,,156,,156,,163,,161,,159,,158,,159,,158,,168],f:[]}]},{g:[0,16,133,0,0,28,126,12,0,0,2,0,60,0,0,0,0,0,0,0,2,91,0,0,32,47,3,157,
2],p:[1,2,1,2],c:[{n:[144,,151,,149,,147,,146,,147,,146,,144,,144,,151,,149,,147,,146,,147,,146,,144],f:[]},{n:[168,,175,,173,,171,,170,,171,,170,,168,,168,,175,,173,,171,,170,,171,,170,,168],f:[]}]},{g:[0,255,116,79,0,255,116,0,83,0,4,6,69,52,0,0,0,0,0,0,2,14,0,0,32,0,0,0,0],p:[1,1,1,1],c:[{n:[144,,151,,149,,147,,146,,147,,146,,144,,144,,151,,149,,147,,146,,147,,146,,144,,,159,,,,159,,,,159,,,,,,,,,,,,159,,159],f:[]}]}],kb:8269,jb:32,pb:3,ub:4},ea=[{g:"ff",r:"m",m:!1,l:0,o:0},{g:"ww",r:"m",m:!1,
l:0,o:0},{g:"ee",r:"m",m:!1,l:0,o:0},{g:"ii",r:"m",m:!1,l:0,o:0},{g:"zz",r:"m",m:!1,l:0,o:0},{g:"ll",r:"m",m:!1,l:0,o:0},{g:"dd",r:"m",m:!1,l:0,o:0},{g:"mf",r:"f",m:!0,l:2,o:0},{g:"mw",r:"w",m:!0,l:2,o:0},{g:"me",r:"e",m:!0,l:2,o:0},{g:"mi",r:"i",m:!0,l:2,o:0},{g:"mz",r:"z",m:!0,l:2,o:0},{g:"ml",r:"l",m:!0,l:2,o:0},{g:"md",r:"d",m:!0,l:2,o:0},{g:"mff",r:"f",m:!0,l:4,o:0},{g:"mww",r:"w",m:!0,l:4,o:0},{g:"mee",r:"e",m:!0,l:4,o:0},{g:"mii",r:"i",m:!0,l:4,o:0},{g:"mzz",r:"z",m:!0,l:4,o:0},{g:"mll",r:"l",
m:!0,l:4,o:0},{g:"mfff",r:"f",m:!0,l:8,o:0},{g:"mwww",r:"w",m:!0,l:8,o:0},{g:"meee",r:"e",m:!0,l:8,o:0},{g:"miii",r:"i",m:!0,l:8,o:0},{g:"mzzz",r:"z",m:!0,l:8,o:0},{g:"mlll",r:"l",m:!0,l:8,o:0},{g:"mddd",r:"d",m:!0,l:8,o:0},{g:"mfi",r:"f",m:!0,l:3,o:0},{g:"mfe",r:"f",m:!0,l:4,o:0},{g:"mwi",r:"w",m:!0,l:3,o:0},{g:"mwe",r:"w",m:!0,l:3,o:0}];function fa(a,b,c){const d=[];for(let e=0;70>e;e++){const f=2*Math.PI*e/70;d.push({x:a+c*Math.cos(f),y:b+c*Math.sin(f)})}return d}
function ha(a){function b(B){return r(d,B[0],B[1],B[2],B[3])}function c(B,D,J,F,E){var x=y(d);x.h.drawImage(g,e.Ia[0],e.Ia[1]+(B?-2:0));x.h.drawImage(l,e.Oa[0],e.Oa[1]+(D?-2:0));J?x.h.drawImage(k,e.na[0],e.na[1]+4):x.h.drawImage(f,e.na[0],e.na[1]);F?x.h.drawImage(u,e.ia[0],e.ia[1]-4):x.h.drawImage(p,e.ia[0],e.ia[1]);E?x.h.drawImage(A,e.la[0],e.la[1]-4):x.h.drawImage(n,e.la[0],e.la[1]);return x}var d=y(a.Ta);a=[];var e={na:[27,20,4,6],Ia:[7,29,8,3],Oa:[17,29,8,3],ia:[5,15,5,7],la:[22,15,5,7]},f=b(e.na),
k=z(f),g=b(e.Ia),l=b(e.Oa),p=b(e.ia),u=z(p),n=b(e.la),A=z(n);for(var v in e){var t=e[v];d.h.clearRect(t[0],t[1],t[2],t[3])}v=[{Y:0,$:0,aa:0,X:0,Z:0},{Y:0,$:0,aa:0,X:0,Z:0},{Y:1,$:0,aa:0,X:0,Z:1},{Y:1,$:0,aa:1,X:0,Z:0},{Y:0,$:1,aa:0,X:1,Z:0},{Y:0,$:1,aa:1,X:0,Z:0}];for(let B in v)t=v[B],t=c(t.Y,t.$,t.aa,t.X,t.Z),a.push(t);return a}class ia{constructor(a){a=y(a);a=C(a,b=>""==b||"#fff"==b||"#ffffff"==b?null:b);a=H(a,1);this.Ta=r(a,0,0,32,32);r(a,32,0,32,32);this.fb=r(a,0,32,64,64)}}
class ja{constructor(a){var b=1.5*m,c=1.5*m,d=K("\ud83d\udccb",1.5*m,1.4);this.y=this.x=0;this.w=b;this.i=c;this.A=d;this.onclick=a}ha(a){var b=a.x;a=a.y;if(b>=this.x&&b<=this.x+this.w&&a>=this.y&&a<=this.y+this.i){if(this.onclick)this.onclick(this);return!0}return!1}N(a){a.save();a.strokeStyle="#f00";a.lineWidth=2;a.strokeRect(this.x,this.y,this.w,this.i);a.restore();a.drawImage(this.A,this.x,this.y,this.w,this.i)}update(){}}
function ka(a,b){let c=a[0],d=b[c[0]][c[1]];for(const e of a){const [f,k]=e;b[f][k]<d&&(c=e,d=b[f][k])}return c}function la(a,b){const c=[b];for(;a.hasOwnProperty(`${b[0]}-${b[1]}`);)b=a[`${b[0]}-${b[1]}`],c.unshift(b);return c}function ma(a,b,c){const d=[];0<b&&d.push([b-1,c]);b<a.rows-1&&d.push([b+1,c]);0<c&&d.push([b,c-1]);c<a.cols-1&&d.push([b,c+1]);return d}
function va(a,b,c,d,e){b=Math.floor(b);c=Math.floor(c);d=Math.floor(d);e=Math.floor(e);const f=[],k=new Set,g={},l=Array(a.rows).fill(null).map(()=>Array(a.cols).fill(Infinity));l[b][c]=0;const p=Array(a.rows).fill(null).map(()=>Array(a.cols).fill(Infinity));p[b][c]=Math.abs(b-d)+Math.abs(c-e);for(f.push([b,c]);0<f.length;){b=ka(f,p);const [u,n]=b;if(u===d&&n===e)return la(g,b);f.splice(f.indexOf(b),1);k.add(`${u}-${n}`);c=ma(a,u,n);for(const A of c){const [v,t]=A;k.has(`${v}-${t}`)||a.tb[v][t]||
(c=l[u][n]+1,c<l[v][t]&&(g[`${v}-${t}`]=b,l[v][t]=c,p[v][t]=c+(Math.abs(v-d)+Math.abs(t-e)),f.includes(A)||f.push(A)))}}return null}class wa{constructor(a){this.tb=a;this.rows=a.length;this.cols=a[0].length}}function xa(a=64,b=64){const c=M(a,b),d=c.h;d.fillStyle="#a67c52";d.fillRect(0,0,a,b);for(let e=0;e<a+b;e++){const f=N(0,a),k=N(0,b),g=N(2,5);d.globalAlpha=O(.15,.35);d.fillStyle=.5<O()?"#c2b280":"#7c5c36";d.beginPath();d.arc(f,k,g,0,2*Math.PI);d.fill()}d.globalAlpha=1;return c}
function ya(a=64,b=64){const c=M(a,b),d=c.h;d.fillStyle="#b0a99f";d.fillRect(0,0,a,b);const e=a/4;b/=4;for(let f=0;4>f;f++)for(let k=0;4>k;k++){let g=k*e+(1===f%2?e/2:0);if(g+e>a)continue;let l=f*b;d.fillStyle=.5<O()?"#d6d2c4":"#a59e91";d.fillRect(g,l,e-2,b-2);d.strokeStyle="#8d867a";d.lineWidth=1;d.strokeRect(g,l,e-2,b-2)}d.globalAlpha=1;return c}
function za(a=64,b=64){const c=M(a,b),d=c.h;d.fillStyle="#639bff";d.fillRect(0,0,a,b);for(let e=0;e<a+b;e++){const f=N(0,a),k=N(0,b),g=N(2,6);d.globalAlpha=O(.15,.35);d.fillStyle="#a3d8ff";d.beginPath();d.arc(f,k,g,0,2*Math.PI);d.fill()}d.globalAlpha=1;return c}
function Aa(a=64){const b=document.createElement("canvas");b.width=b.height=a;const c=b.getContext("2d");c.fillStyle="#e6d3b3";c.fillRect(0,0,a,a);const d=["#d1bfa3","#c2ad8f","#b8a07d","#e0ceb0"],e=a/4*.9,f=a/3*.7;for(let k=0;3>k;k++)for(let g=0;4>g;g++){let l=g*a/4+k%2*a/8,p=k*a/3;c.beginPath();c.ellipse(l+e/2,p+f/2,e/2,f/2,0,0,2*Math.PI);c.fillStyle=d[Math.floor(Math.random()*d.length)];c.shadowColor="#bba98a";c.shadowBlur=4;c.fill();c.shadowBlur=0}c.globalAlpha=.08;c.fillStyle="#fff";c.beginPath();
c.arc(.7*a,.3*a,.25*a,0,2*Math.PI);c.fill();c.globalAlpha=1;return b}function Ba(a,b){var c=Ca(),d={};a.Ya.map(f=>d[f.c]=f.j);a=C(b,f=>""==f?null:f);b=M(64*m,64*m);var e=b.h;e.drawImage(c,0,0);for(let f=0;64>f;f++)for(let k=0;64>k;k++)c=d[a[k][f]],void 0!=c&&e.drawImage(c,f*m,k*m);return b}function Da(a,b){var c={};for(var d in b)c[b[d].c]=b[d].D;b=[];for(d=0;d<a.length;d++){b[d]=[];for(var e=0;e<a[d].length;e++){var f=c[a[e][d]];b[d][e]=void 0!=f&&0==f?0:1}}return b}
function Ea(a=64,b=64){const c=M(a,b),d=c.h;d.fillStyle="#4caf50";d.fillRect(0,0,a,b);for(let e=0;e<a+b;e++){const f=N(0,a),k=N(0,b),g=N(2,5);d.globalAlpha=O(.18,.38);d.fillStyle=.5<O()?"#81c784":"#388e3c";d.beginPath();d.arc(f,k,g,0,2*Math.PI);d.fill()}d.globalAlpha=1;return c}
function Ca(){var a=64*m,b=64*m,c=m*m,d=[K("\ud83c\udf39",12,1.3),K("\ud83c\udf37",12,1.3),K("\ud83c\udf3b",12,1.3),K("\ud83c\udf3c",12,1.3),K("\ud83c\udf31",12,1.3)];const e=M(a,b);var f=e.h,k=Ea(a,b);f.fillStyle="#4caf50";f.drawImage(k,0,0);for(k=0;k<c;k++)f.drawImage(d[N(0,d.length)],N(0,a-12),N(0,b-12));return e}
class Fa{constructor(a){this.L=a;this.$a=this.L.B.w;this.ch=this.L.B.i;var b=xa(m,m),c=ya(m,m),d=za(m,m),e=K("\ud83c\udf33",m,1.3),f=K("\ud83c\udfe1",2*m,1.3),k=K("\ud83c\udfe0",2*m,1.3),g=K("\u26ea",3*m,1.3),l=K("\ud83c\udfeb",3*m,1.3),p=K("\ud83c\udff0",4*m,1.3),u=K("\ud83c\udfea",3*m,1.3),n=K("\u26fa",3*m,1.3),A=Aa(m);this.Ya=[{c:"#99e550",D:0,G:"",j:void 0},{c:"#639bff",D:1,G:"",j:d},{c:"#6abe30",D:1,G:"",j:e},{c:"#76428a",D:1,G:"house1",j:f},{c:"#d77bba",D:1,G:"house2",j:k},{c:"#d9a066",D:0,
G:"",j:b},{c:"#767676",D:1,G:"",j:A},{c:"#df7126",D:1,G:"castle",j:p},{c:"#8f974a",D:1,G:"church",j:g},{c:"#fbf236",D:1,G:"townhall",j:l},{c:"#ac3232",D:1,G:"store",j:u},{c:"#663931",D:0,G:"",j:c},{c:"#524b24",D:1,G:"tent",j:n}];this.nb=C(a.Aa.fb,v=>""==v?null:v);this.map=Ba(this,a.Aa.fb);this.ib=Da(this.nb,this.Ya);this.yb=new wa(this.ib)}N(a){let b=this.map,c;let d,e,f,k;var g=NaN-this.ch/2;c=NaN-this.$a/2;0>=c&&(c=0);0>=g&&(g=0);c+this.w>b.width&&(c=b.width-this.$a);g+this.i>b.height&&(g=b.height-
this.ch);d=f=this.w;e=k=this.i;a.drawImage(b,c,g,d,e,0,0,f,k)}}function Ga(a){var b=[];for(let c=2;5>=c;c++)b.push(a.oa[c]);return b}class Ha{constructor(a){this.oa=ha(a.Aa)}}function Ia(a){a.ka=q;a.Ja=q.pb;a.ua=0;a.ja=q.kb*q.jb*(a.Ja+1)*2;a.R=new Int32Array(a.ja)}
function Ja(a,b,c){Ia(a);var d=()=>{var e,f,k,g,l,p,u=new Int32Array(a.ja);const n=a.ka.Bb[a.ua],A=a.ka.kb,v=a.ka.jb;let t=0,B=0;var D=!1;const J=[];for(k=0;k<=a.Ja;++k){var F=n.p[k];for(g=0;g<v;++g){if(p=F?n.c[F-1].f[g]:0)n.g[p-1]=n.c[F-1].f[g+v]||0,17>p&&(J.length=0);const Za=a.Ka[n.g[16]],$a=n.g[17]/512,ab=2**(n.g[18]-9)/A,bb=n.g[19],na=n.g[20],cb=135.82764118168*n.g[21]/44100,db=1-n.g[22]/255,Z=1E-5*n.g[23],eb=n.g[24]/32,fb=n.g[25]/512,gb=6.283184*2**(n.g[26]-9)/A,oa=n.g[27]/255,aa=n.g[28]*A&
-2;p=(k*v+g)*A;for(l=0;4>l;++l)if(f=F?n.c[F-1].n[g+l*v]:0){if(!J[f]){var E=e=f;var x=a.Ka[n.g[0]];const hb=n.g[1],ib=n.g[3]/32,jb=a.Ka[n.g[4]],kb=n.g[5],lb=n.g[8]/32,pa=n.g[9],L=n.g[10]*n.g[10]*4,S=n.g[11]*n.g[11]*4,ba=n.g[12]*n.g[12]*4,mb=1/ba,nb=-n.g[13]/16;let P=n.g[14];const ob=A*2**(2-n.g[15]),qa=new Int32Array(L+S+ba);let ra=0,sa=0,ta=0,ua=0;for(let I=0,ca=0;I<L+S+ba;I++,ca++){0<=ca&&(P=P>>8|(P&255)<<4,ca-=ob,ta=.003959503758*2**((E+(P&15)+n.g[2]-128-128)/12),ua=.003959503758*2**((E+(P&15)+
n.g[6]-128-128)/12)*(1+8E-4*n.g[7]));let G=1;I<L?G=I/L:I>=L+S&&(G=(I-L-S)*mb,G=(1-G)*3**(nb*G));ra+=ta*G**ib;let da=x(ra)*hb;sa+=ua*G**lb;da+=jb(sa)*kb;pa&&(da+=(2*Math.random()-1)*pa);qa[I]=80*da*G|0}J[e]=qa}E=J[f];f=0;for(e=2*p;f<E.length;f++,e+=2)u[e]+=E[f]}for(f=0;f<A;f++)l=2*(p+f),(e=u[l])||D?(D=cb,bb&&(D*=Za(ab*l)*$a+.5),D=1.5*Math.sin(D),t+=D*B,e=db*(e-B)-t,B+=D*e,e=3==na?B:1==na?e:t,Z&&(e*=Z,e=1>e?-1<e?a.hb(.25*e):-1:1,e/=Z),e*=eb,D=1E-5<e*e,E=Math.sin(gb*l)*fb+.5,x=e*(1-E),e*=E):x=0,l>=aa&&
(x+=u[l-aa+1]*oa,e+=u[l-aa]*oa),u[l]=x|0,u[l+1]=e|0,a.R[l]+=x|0,a.R[l+1]+=e|0}}a.ua++;if(1==a.ua/a.ka.ub){k=b.createBuffer(2,a.ja/2,44100);for(g=0;2>g;g++)for(F=k.getChannelData(g),u=g;u<a.ja;u+=2)F[u>>1]=a.R[u]/65536;return c(k)}requestAnimationFrame(d)};requestAnimationFrame(d)}
class Ka{constructor(){this.Ka=[this.hb,this.wb,this.vb,this.xb];this.ka=null;this.ja=this.ua=this.Ja=0;this.R=null}hb(a){return Math.sin(6.283184*a)}vb(a){return a%1*2-1}wb(a){return.5>a%1?1:-1}xb(a){a=a%1*4;return 2>a?a-1:3-a}getData(a,b){const c=2*Math.floor(44100*a),d=Array(b);for(let e=0;e<2*b;e+=1){const f=c+e;d[e]=0<a&&f<this.R.length?this.R[f]/32768:0}return d}}
function La(a){const b=a.M.sampleRate;a=a.M.createBuffer(1,.3*b,b).getChannelData(0);for(var c=0;c<a.length;c++)a[c]=2*(Math.random()-.5);c=.29-.1;for(let d=0;d<a.length;d++){let e=d/b;.01>e?a[d]*=e/.01:.11>e?a[d]*=1-(e-.01)/.1*.8:e>.3-c&&(a[d]*=(.3-e)/c)}for(c=0;c<a.length;c++)a[c]*=Math.sin(c/b*Math.PI*2*(440+100*Math.random()))}
function Ma(a){const b=a.M.sampleRate;a=a.M.createBuffer(1,.5*b,b).getChannelData(0);for(var c=0;c<a.length;c++)a[c]=2*Math.random()-1;for(c=0;c<a.length;c++){let d=c/b;.05>d?a[c]*=d/.05:.25>d?a[c]*=1-(d-.05)/.2:.25<d&&(a[c]*=(.5-d)/.25)}}function Na(a){a.K&&(a.K.stop(),a.K=null);a.Sa&&(a.K=a.M.createBufferSource(),a.K.buffer=a.Sa,a.K.connect(a.M.destination),a.K.loop=!0,a.K.start(0,a.Ma),a.startTime=a.M.currentTime-a.Ma)}
class Oa{constructor(){this.M=new (window.AudioContext||window.webkitAudioContext);new (window.AudioContext||window.webkitAudioContext);La(this);Ma(this);var a=new Ka;this.startTime=this.Ma=0;Ja(a,this.M,b=>{this.Sa=b;Na(this)})}}function y(a){var b=M(a.width,a.height);b.h.drawImage(a,0,0);return b}
function C(a,b){for(var c=a.getContext("2d").getImageData(0,0,a.width,a.height).data,d=[],e=0;e<c.length;e+=4){var f=d,k=f.push;var g=c[e];var l=c[e+1],p=c[e+2];g=0==g+l+p+c[e+3]?null:0==g+l+p||255<g||255<l||255<p?"#000000":"#"+((g<<16)+(l<<8)+p).toString(16).padStart(6,"0");k.call(f,g)}c=[];for(e=0;e<a.height;e++)c[e]=[];f=e=0;for(k=0;k<d.length;k++)e>=a.width&&(f++,e=0),c[f][e]=d[k],b&&(c[f][e]=b(c[f][e])),e++;return c}
function H(a,b=1){let c=a.length,d=Math.max(...a.map(g=>g.length));var e=M(d*b,c*b),f=e.h;for(let g=0;g<c;g++)for(let l=0;l<d;l++){var k=a[g][l];k&&""!=k&&(f.fillStyle=k,f.fillRect(l*b,g*b,b,b))}return e}function r(a,b,c,d,e){let f=M(d,e);f.h.drawImage(a,b,c,d,e,0,0,d,e);return f}function z(a){let b=M(a.width,a.height),c=b.h;c.save();c.scale(1,-1);c.drawImage(a,0,0,a.width,-1*a.height);c.restore();return b}
function M(a=0,b=0){let c=document.createElement("canvas");c.width=a;c.height=b;c.w=a;c.i=b;c.h=c.getContext("2d");c.s={x:a/2,y:b/2};c.clear=()=>{c.h.clearRect(0,0,a,b)};c.fill=d=>{c.h.fillStyle=d;c.h.fillRect(0,0,a,b)};c.Db=d=>{d=c.h.createPattern(d,"repeat");c.h.fillStyle=d;c.h.fillRect(0,0,a,b)};return c}function K(a,b,c=1.3,d="#000",e="sans-serif"){let f=M(b,b);var k=f.h;k.font=`${b/c}px ${e}`;k.textAlign="center";k.textBaseline="middle";k.fillStyle=d;k.fillText(a,b/2,1.1*b/2);return f}
function N(a=1,b=0){return O(a,b)|0}function O(a=1,b=0){return b+(a-b)*Math.random()}function Pa(a){var b="";for(var c=0;c<a;c++){b+="<tr>";for(var d=0;1>d;d++)b+="<td></td>";b+="</tr>"}a=document.createElement("table");a.innerHTML=b;b=[];c=a.querySelectorAll("tr");for(let e=0;e<c.length;e++)d=c[e].querySelectorAll("td"),d.forEach(f=>f.ea=k=>f.innerHTML=k),b[e]=[...d];a.ab=b;return a}
function Qa(a,b,c){var d=M(b,a),e=d.h,f=Ra(12.5*a/100,null,c);e.fillStyle=c;e.drawImage(f,0,0);e.drawImage(f,a-f.width,0);e.drawImage(f,a-f.width,b-f.height);e.drawImage(f,0,b-f.height);e.fillRect(f.width/2,1,a-f.width,b-2);e.fillRect(1,f.width/2,a-2,b-f.width);return d}
function Ra(a,b=null,c=null,d=1){var e=M(2*a+2,2*a+2),f=e.h;f.save();f.lineWidth=d;f.beginPath();f.arc(e.width/2,e.height/2,a,0,2*Math.PI,!1);null!=b&&(f.strokeStyle=b,f.stroke());null!=c&&(f.fillStyle=c,f.fill());f.restore();return e}function Q(a,b,c,d=.8,e="sans-serif"){a=a.toUpperCase();let f=M(b*a.length,b);for(let g=0;g<a.length;g++){var k=K(a[g],b,d,c,e);f.h.drawImage(k,g*b,0)}return f}
function R(a,b,c="source-atop"){let d=M(a.width,a.height),e=d.h;e.drawImage(a,0,0);e.globalCompositeOperation=c;for(c=0;c<a.width/b.width;c++)for(let f=0;f<a.height/b.height;f++)e.drawImage(b,c*b.width,f*b.height);return d}function T(a){var b=document.createElement("div");b.innerHTML=a;return b.firstChild}
function Sa(a=8,b=8){var c=M(a,b),d=c.h;d.fillStyle="#000";d.fillRect(0,0,c.width,c.height);d.fillStyle="#fff";for(let e=0;e<b;e++)for(let f=0;f<a;f++).001>Math.random()&&d.fillRect(f,e,1,1);return c}function Ta(a){var b="sh1.gif?"+Math.random(),c=new Image;c.src=b;c.addEventListener("load",()=>{a(c)})}function Ua(a){a=y(a);a=C(a,b=>b);return H(a,2)}function Va(a){var b=M(a.w,a.i);b.fill("#fff");b=R(a,b,"source-atop");a=M(a.w+2,a.i+2);a.h.drawImage(b,0,0,a.w,a.i);return a}
function Wa(a){var b=m;return parseInt(a/b)*b+b/2}function Xa(a,b,c){var d=b.getBoundingClientRect();c(new U({x:b.width/d.width*(a.clientX-d.left)+window.scrollX,y:b.height/d.height*(a.clientY-d.top)+window.scrollY}))}function Ya(a){a=C(a);return H(a,2)}function pb(a,b,c=1){var d=a.y==b.y?0:a.y<b.y?c:-c;a.x+=a.x==b.x?0:a.x<b.x?c:-c;a.y+=d}function V(a,b){let c;c=0+Math.pow(a.x-b.x,2);c+=Math.pow(a.y-b.y,2);return c=Math.sqrt(c)}class U{constructor(a){this.x=a.x;this.y=a.y}}
function qb(a){a.layout=T("<div class='layout'></div>");a.sb=T("<div class='header'></div>");a.body=T("<div class='body'></div>");a.rb=T("<div class='footer'></div>");a.layout.appendChild(a.sb);a.layout.appendChild(a.body);a.layout.appendChild(a.rb);document.body.innerHTML="";document.body.appendChild(a.layout)}
class rb{constructor(){this.sa={xa:!1,Fb:!1,controls:!1};qb(this);var a=T("<div>Loading....</div>");this.body.append(a);this.Cb=window.innerHeight/window.innerWidth;1<this.Cb&&(m=32);this.bb=document.createElement("div");document.body.innerHTML=""}}
class sb{constructor(a){this.L=a;this.speed=2;a=this.fa=new Ha(a);this.Da=[a.oa[0],a.oa[1]];this.pa=Ga(this.fa);this.animation={framerate:8,frame:0,Ba:0,Pa:this.Da};this.s=new U({x:3*m-m/2,y:5*m-m/2});this.za=new U(this.s);this.A=this.Da[0];this.wa=!1;this.destination=new U(this.s);this.La=[]}update(){this.animation.Pa=this.wa?this.pa:this.Da;this.animation.frame++;this.animation.frame>=this.animation.framerate&&(this.animation.Ba>=this.animation.Pa.length&&(this.animation.Ba=0),this.A=this.animation.Pa[this.animation.Ba],
this.animation.Ba++,this.animation.frame=0);V(this.destination,this.s)>=this.speed?pb(this.s,this.destination,this.speed):(this.s=new U(this.destination),this.wa=!1);if(0==V(this.destination,this.s)&&0<this.La.length){var a=this.La.shift();this.destination=new U(a);this.wa=!0}}N(a){a.drawImage(this.A,this.s.x-this.A.w/2,this.s.y-this.A.i/2)}ha(a){if(!(a.y<m)){var b=Math.floor(Wa(Math.max(0,this.s.x-this.L.B.w/2)+a.x)/m);a=Math.floor(Wa(Math.max(0,this.s.y-this.L.B.i/2)+a.y)/m);var c;if(c=0==this.wa){try{var d=
1==this.L.Fa.ib[b][a]}catch(e){d=!0}c=!d}if(c){b=va(this.L.Fa.yb,Math.floor(this.s.x/m),Math.floor(this.s.y/m),b,a);d=[];if(1<b.length)for(c=1;c<b.length;c++)a=b[c],d.push(new U({x:a[0]*m+m/2,y:a[1]*m+m/2}));this.La=d}}}}function tb(a){var b=a.u.pop();b=JSON.stringify(b);a.ta.delete(b)}function ub(a){if(0<a.u.length)return a.u[a.u.length-1]}function vb(a){if(1<a.u.length)return a.u[a.u.length-2]}function wb(a){a=a.u.map(b=>b.U);return 0==a.length?" ":a.join("")}
class xb{constructor(){this.ta=new Set;this.u=[]}length(){return this.u.length}add(a){const b=JSON.stringify(a);return this.ta.has(b)?!1:(this.ta.add(b),this.u.push(a),!0)}has(a){return this.ta.has(JSON.stringify(a))}getAll(){return[...this.u]}}
class W{constructor(a){var b=M(a.w,a.i),c=b.h;b.fill(a.color);var d=Q(a.name,14,"#000",1.1);c.drawImage(a.A,b.w/2-a.A.w/2,b.i/2-a.A.i/2);c.drawImage(d,b.w/2-d.w/2,4);c.fillStyle=.4<a.W/a.Ga?"green":"red";c.fillRect(m/5,d.i+4,a.W/a.Ga*(b.w-m/10),4);this.x=a.x;this.y=a.y;this.ma=M(a.w+4,a.i+4);this.ma.fill(a.ma);this.canvas=b}N(a){a.drawImage(this.ma,this.x-2,this.y-2);a.drawImage(this.canvas,this.x,this.y)}}function X(a,b,c){b=K(b,a.O,1.3);return c?R(a.zb,b):R(a.Ab,b)}
function yb(a,b,c,d,e,f,k=!0){if(null==b.flat().find(l=>e(l)))return b;for(let l=0;l<d;l++){const p=[];for(var g=0;g<c;g++)e(b[g][l])||p.push(b[g][l]);if(k)for(g=0;g<c;g++)b[g][l]=g>=c-p.length?p[g-(c-p.length)]:f(g,l);else for(g=0;g<c;g++)b[g][l]=g<p.length?p[g]:f(g,l)}return yb(a,b,c,d,e,f,k)}function zb(a,b,c){var d=a.V[N(0,a.V.length)];return{s:new U({x:a.x+b*a.v+a.v/2,y:a.y+c*a.v+a.v/2}),U:d.H,A:d.j}}
function Ab(a,b){for(let c in b)for(let d in b[c])b[c][d].s=new U({x:a.x+d*a.v+a.v/2,y:a.y+c*a.v+a.v/2}),b[c][d].r=c,b[c][d].c=d}function Bb(a){console.log("reset board");a.C=new xb;var b=[];for(let d=0;d<a.rows;d++){b[d]=[];for(let e=0;e<a.cols;e++){var c=a.V[N(0,a.V.length)];b[d][e]={r:d,c:e,s:new U({x:a.x+e*a.v+a.v/2,y:a.y+d*a.v+a.v/2}),U:c.H,A:c.j}}}a.grid=b;console.log(b)}
function Cb(a){var b=wb(a.C),c=a.O,d=a.O;if(" "==b)return k;var e={};a.V.forEach(l=>e[l.H]=l.j);var f=ea.find(l=>l.g==b);if(f){var k=M(b.length*c+2*c,d);k.fill("green");d=0;for(let l=0;l<b.length;l++){var g=b[l];e[g]&&k.h.drawImage(e[g],d,0);d+=c}f.l?(k.h.drawImage(a.Ra,d,0),d+=c,a=R(a.qb,e[f.r],"source-atop"),k.h.drawImage(a,d,0)):(k.h.drawImage(a.Ra,d,0),d+=c,k.h.drawImage(e[f.r],d,0));d+=c}else for(k=M(b.length*c,d),k.fill("red"),d=0,a=0;a<b.length;a++)g=b[a],e[g]&&k.h.drawImage(e[g],d,0),d+=c;
return k}
class Db{constructor(a){this.L=a;this.v=1.85*m;this.O=.82*this.v;y(a.canvas);this.B=a.B;a.body.innerHTML="";this.canvas=M(this.B.w,this.B.i);this.w=this.canvas.w;this.i=this.canvas.i;a.body.append(this.canvas);this.Ha=!1;this.C=new xb;this.zb=Qa(this.O,this.O,"#fff");this.Ab=Qa(this.O,this.O,"#8c8c8c");this.Ea=K("\u2694",3*m,1.3,"#fff");this.Ra=K("\u27a1",this.O,1.3,"#fff");this.qb=K("\ud83d\udca5",this.O,1.3,"#fff");this.ya={name:"player",W:90,Ga:100,A:Ua(a.Aa.Ta),x:3*m,y:this.canvas.i/5,w:3*m,i:3.5*
m,color:"gold",ma:"#fff"};this.va={name:"target",W:33,Ga:100,A:K("\ud83e\udddf",64,1.3),x:this.canvas.w-3*m-3*m,y:this.canvas.i/5,w:3*m,i:3.5*m,color:"gold",ma:"#fff"};this.Ua=[new W(this.ya),new W(this.va)];this.V=[{H:"m",e:"\ud83d\udd2e",j:X(this,"\ud83d\udd2e",!1),T:X(this,"\ud83d\udd2e",!0),c:"#f00"},{H:"f",e:"\ud83d\udd25",j:X(this,"\ud83d\udd25",!1),T:X(this,"\ud83d\udd25",!0),c:"#f00"},{H:"w",e:"\ud83d\udca7",j:X(this,"\ud83d\udca7",!1),T:X(this,"\ud83d\udca7",!0),c:"#00f"},{H:"e",e:"\ud83c\udf31",
j:X(this,"\ud83c\udf31",!1),T:X(this,"\ud83c\udf31",!0),c:"#0a0"},{H:"i",e:"\ud83c\udf2a\ufe0f",j:X(this,"\ud83c\udf2a\ufe0f",!1),T:X(this,"\ud83c\udf2a\ufe0f",!0),c:"#aaa"},{H:"z",e:"\u26a1",j:X(this,"\u26a1",!1),T:X(this,"\u26a1",!0),c:"#ff0"},{H:"l",e:"\u2600\ufe0f",j:X(this,"\u2600\ufe0f",!1),T:X(this,"\u2600\ufe0f",!0),c:"#ffb"},{H:"d",e:"\ud83c\udf11",j:X(this,"\ud83c\udf11",!1),T:X(this,"\ud83c\udf11",!0),c:"#555"}];this.x=0;this.y=this.canvas.i/2;this.rows=Math.floor(this.canvas.i/this.v/
2);this.cols=Math.floor(this.canvas.w/this.v);this.I=null;this.canvas.addEventListener("mousedown",e=>c(e));this.canvas.addEventListener("mouseup",()=>b());this.canvas.addEventListener("mousemove",e=>d(e));this.canvas.addEventListener("touchstart",e=>c(e));this.canvas.addEventListener("touchend",()=>b());this.canvas.addEventListener("touchmove",e=>d(e));var b=()=>{this.I=null;if(0<this.C.u.length){var e=wb(this.C);console.log(e);var f=ea.find(g=>g.g==e);if(f){if(f.m)console.log(this.C.u),this.C.u.forEach(g=>
{this.grid[g.r][g.c].U=0}),this.grid=yb(this,this.grid,this.rows,this.cols,g=>0==g.U,(g,l)=>zb(this,g,l)),Ab(this,this.grid),this.va.W-=f.l;else{var k=ub(this.C);this.C.u.forEach(g=>{this.grid[g.r][g.c].U=0});k.U=f.r;k.A=this.V.find(g=>g.H==f.r).j;this.grid=yb(this,this.grid,this.rows,this.cols,g=>0==g.U,(g,l)=>zb(this,g,l));Ab(this,this.grid);this.ya.W-=5}this.Ua=[new W(this.ya),new W(this.va)]}}console.log("end");this.Ha=!1;this.C=new xb},c=()=>{console.log("start");this.Ha=!0},d=e=>{Xa(e.touches?
e.touches[0]:e,this.canvas,f=>{var k=new U(f);f=this.grid.flat().find(u=>V(k,u.s)<this.v/2);if(void 0!=f){var g=f.s;if(this.Ha){var l=ub(this.C),p=vb(this.C);null==l||void 0==l?this.C.add(f):null!=p&&V(g,p.s)<this.v/2?tb(this.C):V(g,l.s)<1.5*this.v&&this.C.add(f)}}})};Bb(this);this.update(0)}update(a){var b=this.canvas.h;this.canvas.fill("#000");b.fillStyle="#fff";b.fillText(Math.floor(a/1E3),10,10);b.drawImage(this.Ea,this.canvas.w/2-this.Ea.w/2,this.canvas.i/5-this.Ea.i);a=this.C.getAll();if(1<
a.length){var c=Cb(this);b.drawImage(c,this.x+this.w/2-c.w/2,this.y-this.v);b.strokeStyle="#fff";b.lineWidth=this.v/6;b.beginPath();b.moveTo(a[0].s.x,a[0].s.y);for(c=1;c<a.length;c++)b.lineTo(a[c].s.x,a[c].s.y);b.stroke()}for(a=0;a<this.rows;a++)for(c=0;c<this.cols;c++){var d=this.grid[a][c],e=!1;0!=a%2&&0!=c%2||0==a%2&&0==c%2||(e=!0);var f=this.V.find(k=>k.H==d.U);f&&(e=e?f.T:f.j,b.drawImage(e,d.s.x-e.w/2,d.s.y-e.i/2))}this.Ua.forEach(k=>k.N(b));requestAnimationFrame(k=>this.update(k))}}
function Eb(a){a.ga=!0;a.da=!0;qb(a);a.canvas=M(a.B.w,a.B.i);a.canvas.fill("#000");Fb(a,a.canvas);a.body.append(a.canvas);Y(a)}function Fb(a,b){function c(e){d.update(e);d.N(b);requestAnimationFrame(c)}var d=new Gb(a);d.N(b);requestAnimationFrame(c)}
function Y(a){a.da=!0;null!=a.P&&a.P.remove();a.P=Object.assign(document.createElement("div"),{className:"menuDialog"});var b=[];a.ga?(b.push({ea:"<button >New Game</button>",f:"newgame"}),b.push({ea:"<button >Practice Combat</button>",f:"paracticecombat"})):b.push({ea:"<button >Resume</button>",f:"resume"});b.push({ea:`<button >Music ${a.sa.xa?"ON":"OFF"}</button>`,f:"music"});a.ga||b.push({ea:"<button >Quit</button>",f:"quit"});var c=Pa(b.length);for(let e in b){var d=T(b[e].ea);c.ab[e][0].append(d);
c.ab[e][0].onclick=()=>{var f=b[e].f;"newgame"==f?(a.da=!1,a.ga=!1,Hb(a)):"resume"==f?(a.da=!1,a.P.remove(),a.update(a.time)):"music"==f?(a.Ca||(a.Ca=new Oa),a.sa.xa?(f=a.Ca,f.K&&(f.Ma=f.M.currentTime-f.startTime,f.K.stop(),f.K=null)):Na(a.Ca),a.sa.xa=!a.sa.xa,a.P.remove(),Y(a)):"quit"==f?(document.webkitIsFullScreen&&document.exitFullscreen(),a.da=!0,a.ga=!0,a.P.remove(),Eb(a)):"paracticecombat"==f&&(a.da=!0,a.P.remove(),new Db(a))}}a.P.append(c);a.body.append(a.P)}
function Hb(a){qb(a);a.body.innerHTML="";a.Fa=new Fa(a);a.canvas=M(a.B.w,a.B.i);a.body.innerHTML="";a.body.appendChild(a.canvas);a.body.appendChild(a.bb);a.Na=new sb(a);a.gb=[new ja(()=>{Y(a)})];a.u=[a.Na];a.body.innerHTML="";a.body.appendChild(a.canvas);a.body.appendChild(a.bb);a.update(0);window.addEventListener("keyup",d=>{"Escape"==d.key&&Y(a)});a.I=null;a.canvas.addEventListener("mousedown",d=>b(d));a.canvas.addEventListener("mouseup",()=>{a.I=null});a.canvas.addEventListener("mousemove",d=>
c(d));a.canvas.addEventListener("touchstart",d=>b(d));a.canvas.addEventListener("touchend",()=>{a.I=null});a.canvas.addEventListener("touchmove",d=>c(d));var b=d=>{Xa(d.touches?d.touches[0]:d,a.canvas,e=>{a.I={x:e.x,y:e.y}})},c=d=>{a.I&&Xa(d.touches?d.touches[0]:d,a.canvas,e=>{a.I={x:e.x,y:e.y}})}}
class Ib extends rb{constructor(){super();this.B={w:600,i:600};Ta(a=>{this.Aa=new ia(a);this.u=[];Eb(this)})}update(a){if(1!=this.da){if(1==this.ga)return this.Eb();this.u.forEach(d=>d.update(a));var b=y(this.Fa.map),c=b.h;this.u.sort((d,e)=>{let f,k;return d.za?null==(f=d.za)?void 0:f.y:Infinity-e.za?null==(k=e.za)?void 0:k.y:Infinity});this.u.forEach(d=>d.N(c));b=r(b,Math.max(0,this.Na.s.x-this.B.w/2),Math.max(0,this.Na.s.y-this.B.i/2),this.B.w,this.B.i);this.canvas.fill("#fff");this.canvas.h.drawImage(b,
0,0);this.canvas.h.fillRect;this.gb.forEach(d=>d.N(this.canvas.h));this.I&&(this.u.forEach(d=>{d.ha&&d.ha(this.I)}),this.gb.forEach(d=>{d.ha&&d.ha(this.I)}),this.I=null);this.time=a;requestAnimationFrame(d=>this.update(d))}}}function Jb(a){var b="THE FAMILIAR".split(""),c=M(64*b.length,m+4),d=0;for(let k in b){var e=Q(b[k],m,"#fff",1.1,"cursive"),f=Q(b[k],m,"#b90000",1.1,"cursive");c.h.drawImage(e,d+1,1);c.h.drawImage(f,d,0);d+=m}a.F={A:c,cb:128,eb:a.Qa,ca:0}}
class Gb{constructor(a){this.L=a;this.fa=new Ha(a);this.Za=Q("BY MHMDJAWADZD",16,"#fff",1.5,"cursive");this.Va=this.fa.oa[0];this.Wa=Va(this.Va);this.Wa.h.drawImage(this.Va,1,1);this.canvas=M(a.B.w,a.B.i);Ya(this.Wa);this.pa=Ga(this.fa);this.Xa=this.pa.map(c=>Va(c));this.Xa.forEach((c,d)=>c.h.drawImage(this.pa[d],1,1));this.ob=this.Xa.map(c=>Ya(c));this.lb=Sa(3*this.canvas.w,this.canvas.i);this.S=5;this.elements=[{j:K("\ud83d\udd25",32,1.3),c:"#ee4000c7",g:0,t:this.S},{j:K("\ud83d\udca7",32,1.3),
c:"#00c7eec7",g:10,t:this.S},{j:K("\ud83c\udf31",32,1.3),c:"#805a05c7",g:20,t:this.S},{j:K("\ud83c\udf2a\ufe0f",32,1.3),c:"#cdcf84c7",g:30,t:this.S},{j:K("\u26a1",32,1.3),c:"#f9ff30c7",g:40,t:this.S},{j:K("\u2600\ufe0f",32,1.3),c:"#f8ff00c7",g:50,t:this.S},{j:K("\ud83c\udf11",32,1.3),c:"#a83bf3c7",g:60,t:this.S}];this.ba=Ra(4*m,"#fff",null,3);Ra(m/9,"#00f","#00f",3);a=this.canvas.i-this.ba.i/2-m;var b={x:this.canvas.w/2,y:a,r:this.ba.w/2};this.ra=fa(b.x,b.y,b.r);this.qa=b;this.Qa=a-this.ba.i/2-m;
this.J={mb:this.ob,current:0,frames:0,framerate:16,cb:64,eb:this.Qa};Jb(this)}N(a){a.h.drawImage(this.canvas,0,0)}update(){this.canvas.h.drawImage(this.lb,0,0,N(0,this.lb.w-this.canvas.w),this.canvas.i,0,0,this.canvas.w,this.canvas.i);this.canvas.h.drawImage(this.ba,this.qa.x-this.ba.w/2,this.qa.y-this.ba.i/2);this.canvas.h.drawImage(this.J.mb[this.J.current],this.qa.x-32,this.qa.y-32);this.J.frames++;this.J.frames>this.J.framerate&&(this.J.frames=0,this.J.current++,this.J.current>=this.J.mb.length&&
(this.J.current=0));this.canvas.h.drawImage(this.F.A,0,0,this.F.ca,this.F.A.i,this.F.cb,this.F.eb,this.F.ca,this.F.A.i);this.F.ca+=4;this.F.ca>this.F.A.w&&(this.F.ca=0);this.elements.forEach(a=>{var b=this.ra[a.g%this.ra.length];this.canvas.h.drawImage(a.j,b.x-a.j.w/2,b.y-a.j.i/2);var c=this.elements.filter(d=>d!=a)[N(this.elements.length-1)];c=this.ra[c.g%this.ra.length];this.canvas.h.save();this.canvas.h.strokeStyle=a.c;this.canvas.h.lineWidth=2;this.canvas.h.beginPath();this.canvas.h.moveTo(b.x,
b.y);this.canvas.h.lineTo(c.x,c.y);this.canvas.h.stroke();this.canvas.h.restore();a.t--;0>=a.t&&(a.t=this.S,a.g++)});this.canvas.h.drawImage(this.Za,0,this.canvas.i-this.Za.i)}}document.addEventListener("DOMContentLoaded",function(){window.L=new Ib},!1);
